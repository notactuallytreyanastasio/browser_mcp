import{a as t,t as e,_ as i,ay as s,g as a,n,J as o,az as l,P as r,l as d,L as c,T as h,w as p,x as m,aA as u,e as v}from"./shell-2264602c.js";import{s as b,x as y,c as T,I as x}from"./icon-82dd10b4.js";import{g as f,h as I}from"./translations-8a80e526.js";import"./chat-mobile-xpromo-client-js-c803f3b0.js";import"./app-selector-client-js-3a92da0e.js";const g=t(b),k="translation-intervention-modal",{I18nPostTranslationOverride:C,I18nCommentTranslationOverride:w}=h,A=()=>!!d.getItem(c.I18nTranslationInterventionShown),O=()=>d.setItem(c.I18nTranslationInterventionShown,"true");let S=class extends g{constructor(){super(...arguments),this.translationContextValue=l,this.open=!1,this.pubsub=new r(this),this.handleTranslationOverride=t=>{t.isContextUpdateEvent||A()||this.open||(this.translationOverrideActive=t.isTranslationActive,this.translationSourceId=t.id,this.show())},this.show=()=>{A()||(this.open=!0,this.modal?.showModal(),O())},this.close=()=>{this.translationOverrideActive=void 0,this.translationSourceId=void 0,this.open&&(this.modal?.close(),this.open=!1,this.dispatchEvent(new CustomEvent("translation-intervention-modal:close",{bubbles:!0,composed:!0})))},this.getThingTelemetryMetadata=()=>({post:"post"===this.mode?{id:this.translationSourceId,translation_state:!!this.translationOverrideActive}:"mtseo-post"===this.mode?{id:this.translationSourceId}:void 0,comment:"comment"===this.mode?{id:this.translationSourceId,translation_state:!!this.translationOverrideActive}:void 0}),this.handleDismiss=()=>{this.trackEvent(f({isImmersiveTranslationsActive:!!this.translationContextValue.isTranslationActive,isImmersiveVisit:this.isImmersiveVisit,...this.getThingTelemetryMetadata()})),this.close()},this.handleClick=t=>{this.trackEvent(I({actionType:t,isImmersiveTranslationsActive:"keep"===t?!!this.translationContextValue.isTranslationActive:!this.translationContextValue.isTranslationActive,isImmersiveVisit:this.isImmersiveVisit,...this.getThingTelemetryMetadata()})),"keep"===t?this.close():this.handleSubmit()},this.handleSubmit=()=>{"mtseo-post"===this.mode&&d.setItem(c.I18nTranslationInterventionShown,"mtseo-disabled");const t=this.translationOverrideActive;this.dispatchContextUpdateEvent(t),this.close()}}connectedCallback(){super.connectedCallback(),A()||("post"===this.mode&&this.pubsub.subscribe(C,this.handleTranslationOverride,!1),"comment"===this.mode&&this.pubsub.subscribe(w,this.handleTranslationOverride,!1))}disconnectedCallback(){super.disconnectedCallback(),"post"===this.mode&&this.pubsub.unsubscribe(C,this.handleTranslationOverride),"comment"===this.mode&&this.pubsub.unsubscribe(w,this.handleTranslationOverride)}dispatchContextUpdateEvent(t){const e=new CustomEvent("update-translation-context",{bubbles:!0,composed:!0,detail:{...this.translationContextValue,isTranslationActive:t}});this.dispatchEvent(e),this.pubsub.publish(h.I18nPostTranslationOverride,{isTranslationActive:t,id:"",isContextUpdateEvent:!0,pageType:"feed"===this.pageType?"FEED":"PDP"})}render(){const t=this.translationOverrideActive?{body:"It looks like you know another language. Would you like all your content automatically translated?",confirmButton:"Continue Without Translations",cancelButton:"Turn On Translations"}:{body:"It looks like you know another language. Would you like to keep automatic translations turned on?",confirmButton:"Continue With Translations",cancelButton:"Turn off Translations"};return y` <faceplate-modal blocking ?open="${this.open}" class="${k} w-[350px] m:w-[320px] h-fit z-10"> <div slot="title" class="w-full m:w-fit"> <h3 class="my-0 font-bold inline-flex text-18" data-testid="i18n-modal-title"> Update translations on Reddit </h3> </div> <div slot="closeButton" class="flex items-center"> ${p({attributes:{"aria-label":"Close","data-testid":"i18n-modal-close-button",onclick:this.handleDismiss},appearance:"secondary",leadingIcon:T({size:x.Small}),size:m.Small})} </div> <div class="flex flex-col w-full box-border"> <span class="text-16 my-lg text-pretty">${t.body}</span> <div class="flex flex-col w-full items-stretch gap-xs"> ${p({appearance:"primary",size:m.Large,shape:"pill",attributes:{className:"flex box-border w-full","data-testid":"i18n-modal-confirm-button",onclick:this.handleClick.bind(this,"keep")},children:y`<span class="font-semibold text-14">${t.confirmButton}</span>`})} ${p({appearance:"secondary",size:m.Large,shape:"pill",attributes:{className:"flex box-border w-full","data-testid":"i18n-modal-cancel-button",onclick:this.handleClick.bind(this,"change")},children:y`<span class="font-semibold text-14">${t.cancelButton}</span>`})} </div> </div> </faceplate-modal> `}};S.styles=[e],i([s({context:u,subscribe:!0}),a()],S.prototype,"translationContextValue",void 0),i([n({type:String,attribute:"mode"})],S.prototype,"mode",void 0),i([n({type:Boolean,attribute:"open"})],S.prototype,"open",void 0),i([n({type:String,attribute:"page-type"})],S.prototype,"pageType",void 0),i([n({type:Boolean,attribute:"is-immersive-visit"})],S.prototype,"isImmersiveVisit",void 0),i([a()],S.prototype,"translationOverrideActive",void 0),i([a()],S.prototype,"translationSourceId",void 0),i([o(`faceplate-modal.${k}`)],S.prototype,"modal",void 0),S=i([v("translation-intervention-modal")],S);
