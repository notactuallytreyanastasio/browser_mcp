import{a as t,t as e,_ as o,n,J as i,b4 as s,bc as r,ei as a,y as l,c,ej as u,ek as h,e as p}from"./shell-2264602c.js";import{A as d,b as g}from"./auth-flow-controller-ebc6bc41.js";import{G as S}from"./google-api-3da8618d.js";import{aR as f,x as w}from"./age-gate-standalone-client-js-5357b0cf.js";import{W as y}from"./with-recaptcha-32f8e610.js";import{a as m,s as b,A as v,x as A}from"./icon-82dd10b4.js";let C;const k=new Uint8Array(16);function I(){if(!C&&(C="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!C))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return C(k)}var O=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const x=[];for(let t=0;t<256;++t)x.push((t+256).toString(16).slice(1));function B(t,e=0){return(x[t[e+0]]+x[t[e+1]]+x[t[e+2]]+x[t[e+3]]+"-"+x[t[e+4]]+x[t[e+5]]+"-"+x[t[e+6]]+x[t[e+7]]+"-"+x[t[e+8]]+x[t[e+9]]+"-"+x[t[e+10]]+x[t[e+11]]+x[t[e+12]]+x[t[e+13]]+x[t[e+14]]+x[t[e+15]]).toLowerCase()}function E(t){if(!function(t){return"string"==typeof t&&O.test(t)}(t))throw TypeError("Invalid UUID");let e;const o=new Uint8Array(16);return o[0]=(e=parseInt(t.slice(0,8),16))>>>24,o[1]=e>>>16&255,o[2]=e>>>8&255,o[3]=255&e,o[4]=(e=parseInt(t.slice(9,13),16))>>>8,o[5]=255&e,o[6]=(e=parseInt(t.slice(14,18),16))>>>8,o[7]=255&e,o[8]=(e=parseInt(t.slice(19,23),16))>>>8,o[9]=255&e,o[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,o[11]=e/4294967296&255,o[12]=e>>>24&255,o[13]=e>>>16&255,o[14]=e>>>8&255,o[15]=255&e,o}function U(t,e,o){function n(t,n,i,s){var r;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));const e=[];for(let o=0;o<t.length;++o)e.push(t.charCodeAt(o));return e}(t)),"string"==typeof n&&(n=E(n)),16!==(null===(r=n)||void 0===r?void 0:r.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+t.length);if(a.set(n),a.set(t,n.length),a=o(a),a[6]=15&a[6]|e,a[8]=63&a[8]|128,i){s=s||0;for(let t=0;t<16;++t)i[s+t]=a[t];return i}return B(a)}try{n.name=t}catch(t){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function W(t){return 14+(t+64>>>9<<4)+1}function G(t,e){const o=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(o>>16)<<16|65535&o}function D(t,e,o,n,i,s){return G((r=G(G(e,t),G(n,s)))<<(a=i)|r>>>32-a,o);var r,a}function F(t,e,o,n,i,s,r){return D(e&o|~e&n,t,e,i,s,r)}function N(t,e,o,n,i,s,r){return D(e&n|o&~n,t,e,i,s,r)}function T(t,e,o,n,i,s,r){return D(e^o^n,t,e,i,s,r)}function R(t,e,o,n,i,s,r){return D(o^(e|~n),t,e,i,s,r)}U("v3",48,(function(t){if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let o=0;o<e.length;++o)t[o]=e.charCodeAt(o)}return function(t){const e=[],o=32*t.length,n="0123456789abcdef";for(let i=0;i<o;i+=8){const o=t[i>>5]>>>i%32&255,s=parseInt(n.charAt(o>>>4&15)+n.charAt(15&o),16);e.push(s)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[W(e)-1]=e;let o=1732584193,n=-271733879,i=-1732584194,s=271733878;for(let e=0;e<t.length;e+=16){const r=o,a=n,l=i,c=s;o=F(o,n,i,s,t[e],7,-680876936),s=F(s,o,n,i,t[e+1],12,-389564586),i=F(i,s,o,n,t[e+2],17,606105819),n=F(n,i,s,o,t[e+3],22,-1044525330),o=F(o,n,i,s,t[e+4],7,-176418897),s=F(s,o,n,i,t[e+5],12,1200080426),i=F(i,s,o,n,t[e+6],17,-1473231341),n=F(n,i,s,o,t[e+7],22,-45705983),o=F(o,n,i,s,t[e+8],7,1770035416),s=F(s,o,n,i,t[e+9],12,-1958414417),i=F(i,s,o,n,t[e+10],17,-42063),n=F(n,i,s,o,t[e+11],22,-1990404162),o=F(o,n,i,s,t[e+12],7,1804603682),s=F(s,o,n,i,t[e+13],12,-40341101),i=F(i,s,o,n,t[e+14],17,-1502002290),n=F(n,i,s,o,t[e+15],22,1236535329),o=N(o,n,i,s,t[e+1],5,-165796510),s=N(s,o,n,i,t[e+6],9,-1069501632),i=N(i,s,o,n,t[e+11],14,643717713),n=N(n,i,s,o,t[e],20,-373897302),o=N(o,n,i,s,t[e+5],5,-701558691),s=N(s,o,n,i,t[e+10],9,38016083),i=N(i,s,o,n,t[e+15],14,-660478335),n=N(n,i,s,o,t[e+4],20,-405537848),o=N(o,n,i,s,t[e+9],5,568446438),s=N(s,o,n,i,t[e+14],9,-1019803690),i=N(i,s,o,n,t[e+3],14,-187363961),n=N(n,i,s,o,t[e+8],20,1163531501),o=N(o,n,i,s,t[e+13],5,-1444681467),s=N(s,o,n,i,t[e+2],9,-51403784),i=N(i,s,o,n,t[e+7],14,1735328473),n=N(n,i,s,o,t[e+12],20,-1926607734),o=T(o,n,i,s,t[e+5],4,-378558),s=T(s,o,n,i,t[e+8],11,-2022574463),i=T(i,s,o,n,t[e+11],16,1839030562),n=T(n,i,s,o,t[e+14],23,-35309556),o=T(o,n,i,s,t[e+1],4,-1530992060),s=T(s,o,n,i,t[e+4],11,1272893353),i=T(i,s,o,n,t[e+7],16,-155497632),n=T(n,i,s,o,t[e+10],23,-1094730640),o=T(o,n,i,s,t[e+13],4,681279174),s=T(s,o,n,i,t[e],11,-358537222),i=T(i,s,o,n,t[e+3],16,-722521979),n=T(n,i,s,o,t[e+6],23,76029189),o=T(o,n,i,s,t[e+9],4,-640364487),s=T(s,o,n,i,t[e+12],11,-421815835),i=T(i,s,o,n,t[e+15],16,530742520),n=T(n,i,s,o,t[e+2],23,-995338651),o=R(o,n,i,s,t[e],6,-198630844),s=R(s,o,n,i,t[e+7],10,1126891415),i=R(i,s,o,n,t[e+14],15,-1416354905),n=R(n,i,s,o,t[e+5],21,-57434055),o=R(o,n,i,s,t[e+12],6,1700485571),s=R(s,o,n,i,t[e+3],10,-1894986606),i=R(i,s,o,n,t[e+10],15,-1051523),n=R(n,i,s,o,t[e+1],21,-2054922799),o=R(o,n,i,s,t[e+8],6,1873313359),s=R(s,o,n,i,t[e+15],10,-30611744),i=R(i,s,o,n,t[e+6],15,-1560198380),n=R(n,i,s,o,t[e+13],21,1309151649),o=R(o,n,i,s,t[e+4],6,-145523070),s=R(s,o,n,i,t[e+11],10,-1120210379),i=R(i,s,o,n,t[e+2],15,718787259),n=R(n,i,s,o,t[e+9],21,-343485551),o=G(o,r),n=G(n,a),i=G(i,l),s=G(s,c)}return[o,n,i,s]}(function(t){if(0===t.length)return[];const e=8*t.length,o=new Uint32Array(W(e));for(let n=0;n<e;n+=8)o[n>>5]|=(255&t[n/8])<<n%32;return o}(t),8*t.length))}));var $={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function _(t,e,o){if($.randomUUID&&!t)return $.randomUUID();const n=(t=t||{}).random||(t.rng||I)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,B(n)}function j(t,e,o,n){switch(t){case 0:return e&o^~e&n;case 1:case 3:return e^o^n;case 2:return e&o^e&n^o&n}}function z(t,e){return t<<e|t>>>32-e}U("v5",80,(function(t){const e=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=[];for(let o=0;o<e.length;++o)t.push(e.charCodeAt(o))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const n=t.length/4+2,i=Math.ceil(n/16),s=new Array(i);for(let e=0;e<i;++e){const o=new Uint32Array(16);for(let n=0;n<16;++n)o[n]=t[64*e+4*n]<<24|t[64*e+4*n+1]<<16|t[64*e+4*n+2]<<8|t[64*e+4*n+3];s[e]=o}s[i-1][14]=8*(t.length-1)/Math.pow(2,32),s[i-1][14]=Math.floor(s[i-1][14]),s[i-1][15]=8*(t.length-1)&4294967295;for(let t=0;t<i;++t){const n=new Uint32Array(80);for(let e=0;e<16;++e)n[e]=s[t][e];for(let t=16;t<80;++t)n[t]=z(n[t-3]^n[t-8]^n[t-14]^n[t-16],1);let i=o[0],r=o[1],a=o[2],l=o[3],c=o[4];for(let t=0;t<80;++t){const o=Math.floor(t/20),s=z(i,5)+j(o,r,a,l)+c+e[o]+n[t]>>>0;c=l,l=a,a=z(r,30)>>>0,r=i,i=s}o[0]=o[0]+i>>>0,o[1]=o[1]+r>>>0,o[2]=o[2]+a>>>0,o[3]=o[3]+l>>>0,o[4]=o[4]+c>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,255&o[0],o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,255&o[1],o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,255&o[2],o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,255&o[3],o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,255&o[4]]}));const L=t(y(b));let M=class extends L{constructor(){super(...arguments),this.authFlow=s.Unknown,this.locale="en-EN",this.useCaptcha=!1,this.disableGoogleSSOButton=!1,this.disableAppleSSOButton=!1,this.subscribeToEmailDigest=!1,this.shouldNotTrackContinueWithGoogleTelemetry=!1,this.googleApiController=new S(this,S.ButtonUX),this.googleSSOButtonWidth=0,this.googleSlotName=`${this.tagName.toLowerCase()}-google-${_()}`,this.googleSlotController=new f(this,this.googleSlotName),this.appleSlotName=`${this.tagName.toLowerCase()}-apple-${_()}`,this.appleSlotController=new f(this,this.appleSlotName),this.authFlowController=new d(this),this.renderGoogleSSOButton=()=>{const t=this.googleSlotController.slotted;if(t?.classList.add("h-[40px]"),0===this.container.clientWidth)return;const e=Math.max(Math.min(this.container.clientWidth,400),251);e!==this.googleSSOButtonWidth&&(this.googleSSOButtonWidth=e,window.google?.accounts.id.renderButton(t,{logo_alignment:"left",size:"large",shape:"pill",text:"continue_with",theme:"outline",type:"standard",locale:this.locale,width:this.googleSSOButtonWidth,state:this.googleSlotName}))},this.onGoogleCredentialResponse=async t=>{if(!this.isConnected)return;const e=this.getActiveElement();if(e===document.body||this.contains(e)||this.googleSlotController.slotted?.contains(e))try{const e=S.parseCredentialResponse(t);this.dispatchSSOAuthSuccess({email:e.email,idToken:t.credential,isSignedInAutomatically:!1,provider:r.Google})}catch(t){window.Sentry?.captureException?.(t),this.dispatchSSOAuthFailure(r.Google)}},this.initAppleSSOButton=()=>{if(!this.isConnected)return;if(this.disableAppleSSOButton)return;const t=this.appleSlotController.slotted;if(t){t.id=a;try{window.AppleID.auth.init({clientId:CLIENT_CONFIG.APPLE_SSO_CLIENT_ID,redirectURI:window.location.origin,scope:"email",state:l.get("csrf_token"),usePopup:!0})}catch(t){window.Sentry?.captureException?.(t)}finally{t.id="",this.dispatchEvent(c("focusable-content-loaded"))}}else window.Sentry?.captureMessage?.("Apple SSO button container could not be found")},this.onAppleIDSignInOnSuccess=({detail:t})=>{if(!this.isConnected)return;if(!t?.authorization)return window.Sentry?.captureMessage?.("Apple sign in success event is missing authorization data"),void this.dispatchSSOAuthFailure(r.Apple,"missing_data");const e=t.authorization.id_token;if(!e)return window.Sentry?.captureMessage?.("Apple sign in success event is missing an id token"),void this.dispatchSSOAuthFailure(r.Apple,"missing_token");this.dispatchSSOAuthSuccess({email:t.user?.email||"",idToken:e,isSignedInAutomatically:!1,provider:r.Apple})},this.onAppleIDSignInFailure=({detail:t})=>{this.isConnected&&"popup_closed_by_user"!==t?.error&&this.dispatchSSOAuthFailure(r.Apple,t?.error)}}insertRecaptcha(){this.captchaSiteKey=this.getAttribute("site-key")??void 0,this.captchaSiteKey&&this.insertRecaptchaScript()}connectedCallback(){super.connectedCallback?.(),this.googleSSOButtonWidth=0,this.initGoogleSSOButton(),document.addEventListener("AppleIDSignInOnFailure",this.onAppleIDSignInFailure),document.addEventListener("AppleIDSignInOnSuccess",this.onAppleIDSignInOnSuccess),this.insertRecaptcha()}disconnectedCallback(){super.disconnectedCallback?.(),document.removeEventListener("AppleIDSignInOnFailure",this.onAppleIDSignInFailure),document.removeEventListener("AppleIDSignInOnSuccess",this.onAppleIDSignInOnSuccess),this.resizeObserver?.disconnect()}firstUpdated(){this.injectScript(u,this.initAppleSSOButton)}async injectScript(t,e){try{await w(`script#${t}`),e()}catch(t){window.Sentry?.captureException?.(t)}}getActiveElement(){return document.activeElement}async initGoogleSSOButton(){this.isConnected&&(await this.googleApiController.initialize(),window.google&&(this.resizeObserver=new ResizeObserver(this.renderGoogleSSOButton),this.resizeObserver.observe(this.container)),this.dispatchEvent(c("focusable-content-loaded")))}renderGoogleSSOButtonContainer(){return this.disableGoogleSSOButton?v:A` <div class="focusable"> <div class="rounded-[20px] h-[40px] flex justify-center items-center box-border overflow-hidden relative capitalize"> <slot class="${h}" name="${this.googleSlotName}" @click="${this.onContinueWithGoogleClick}" @keydown="${this.onContinueWithGoogleKeydown}"></slot> </div> </div> `}renderAppleSSOButtonContainer(){return this.disableAppleSSOButton?v:A` <div class="relative focusable"> <div class="rounded-[20px] h-[40px] bg-white border-sm border-solid border-[#dadce0] cursor-pointer px-sm overflow-hidden relative text-center select-none align-middle whitespace-nowrap"> <div class="text-[#131313] flex flex-nowrap flex-row h-100 items-center justify-between relative w-100"> <svg height="18" viewBox="0 0 18 18" width="18" xmlns="http://www.w3.org/2000/svg"> <path fill="currentColor" strike="inherit" d="m8.8162 4.15385c.78824 0 1.7763-.54927 2.3647-1.28163.5329-.6637.9215-1.59059.9215-2.517484 0-.125875-.0111-.251748-.0333-.354736-.8771.0343293-1.9318.606484-2.56458 1.37317-.49959.5836-.95477 1.49905-.95477 2.43738 0 .13732.02221.27464.03331.32041.05551.01144.14433.02289.23314.02289zm-2.77549 13.84615c1.07689 0 1.55427-.7438 2.89761-.7438 1.36558 0 1.66528.7209 2.86428.7209 1.1768 0 1.9651-1.1214 2.7089-2.2199.8327-1.2588 1.1768-2.4946 1.199-2.5519-.0777-.0228-2.3314-.9726-2.3314-3.63887 0-2.3115 1.7763-3.35283 1.8762-3.43293-1.1768-1.73935-2.9642-1.78512-3.4527-1.78512-1.3211 0-2.39799.8239-3.07521.8239-.73274 0-1.69861-.77813-2.84211-.77813-2.17599 0-4.38528 1.85378-4.38528 5.35537 0 2.17418.82155 4.47428 1.83183 5.96188.86595 1.2587 1.62088 2.2886 2.70888 2.2886z"/> </svg> <span class="flex-grow font-[500] text-14 overflow-hidden overflow-ellipsis align-top"> Continue With Apple </span> </div> <div class="opacity-0 absolute top-0 left-0 right-0 bottom-0"> <slot class="${a}" name="${this.appleSlotName}" @click="${this.onContinueWithAppleClick}" @keydown="${this.onContinueWithAppleKeydown}"></slot> </div> </div> </div> `}dispatchSSOAuthFailure(t,e="unknown"){this.authFlowController.trackSSOFailure({authFlow:this.authFlow,provider:t,reason:e})}async dispatchSSOAuthSuccess(t){let e;this.useCaptcha&&(e=await this.getRecaptchaTokenSafe()??void 0),this.authFlowController.identityProviderSigin({...t,recaptchaToken:e,authFlow:this.authFlow,subscribeToEmailDigest:this.subscribeToEmailDigest})}onContinueWithGoogleClick(){this.trackContinueWithGoogle()}onContinueWithGoogleKeydown(t){"Enter"!==t.key&&"Space"!==t.key||this.trackContinueWithGoogle()}onContinueWithAppleClick(){this.trackContinueWithApple()}onContinueWithAppleKeydown(t){"Enter"!==t.key&&"Space"!==t.key||this.trackContinueWithApple()}trackContinueWithGoogle(){this.shouldNotTrackContinueWithGoogleTelemetry||this.trackEvent(g(this.authFlow,r.Google))}trackContinueWithApple(){this.trackEvent(g(this.authFlow,r.Apple))}render(){return A` <div id="container" class="flex flex-col gap-xs mx-auto max-w-[400px]"> ${this.renderGoogleSSOButtonContainer()} ${this.renderAppleSSOButtonContainer()} </div> `}};M.styles=[m`.focusable:focus-within{outline:-webkit-focus-ring-color auto 1px;outline-offset:2px}`,e],o([n({type:String,attribute:"auth-flow"})],M.prototype,"authFlow",void 0),o([n({type:String,attribute:"locale"})],M.prototype,"locale",void 0),o([n({type:Boolean,attribute:"use-captcha"})],M.prototype,"useCaptcha",void 0),o([n({type:Boolean,attribute:"disable-google-sso-button"})],M.prototype,"disableGoogleSSOButton",void 0),o([n({type:Boolean,attribute:"disable-apple-sso-button"})],M.prototype,"disableAppleSSOButton",void 0),o([n({type:Boolean,attribute:"subscribe-to-email"})],M.prototype,"subscribeToEmailDigest",void 0),o([n({type:Boolean,attribute:"should-not-track-continue-with-google-telemetry"})],M.prototype,"shouldNotTrackContinueWithGoogleTelemetry",void 0),o([i("#container")],M.prototype,"container",void 0),M=o([p("auth-flow-sso-buttons")],M);
