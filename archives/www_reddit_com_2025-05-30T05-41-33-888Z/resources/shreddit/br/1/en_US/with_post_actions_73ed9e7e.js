import"./header-action-item-chat-client-js-8d009dcd.js";import{au as t,fP as e,e9 as i,a as s,_ as o,n as a,g as r,ay as n,aA as d,az as l,r as c,c as p,I as h,ew as m,T as u,fQ as g,w as b,x as v,P,o as y,fR as f,u as A,dF as C,dH as k,fS as w,U as I,M as S,O as E}from"./shell-2264602c.js";import{h as R}from"./profile-creation-1d60123b.js";import{d as T,W as U}from"./with-share-1ad32a0e.js";import{P as M}from"./rpl-popper-2d8cefe0.js";import"./tooltip.base-7152f24f.js";import{x,bZ as F,$ as D,b_ as O,H as N,bB as _,bf as B,V as L,b$ as V,aR as H,bi as j,h as $,c0 as W,az as K,c1 as z,c2 as G,bU as Q,bt as Y,c3 as q,aD as X,bn as Z,av as J,a_ as tt,c4 as et,c5 as it,a8 as st,c6 as ot,c7 as at,E as rt,a3 as nt,C as dt,bs as lt,c8 as ct,c9 as pt,bm as ht,a1 as mt,j as ut,c as gt,aU as bt,y as vt,aV as Pt,aX as yt,aW as ft,au as At,a$ as Ct,bP as kt,aZ as wt,aY as It}from"./icon-82dd10b4.js";import{A as St}from"./award-controller-c1fa775d.js";import"./promote-post-button-9b9319e1.js";import{P as Et}from"./promote-post-actions-controller-f5bf291f.js";import{S as Rt}from"./start-end-ama-actions-controller-aa6cb3b4.js";import{t as Tt}from"./modActions-c13cf697.js";import{a as Ut}from"./awardsTelemetryState-e939bf46.js";import{c as Mt,e as xt,P as Ft,u as Dt,R as Ot,f as Nt,g as _t,h as Bt,i as Lt,j as Vt,k as Ht,l as jt,m as $t,n as Wt,o as Kt}from"./overflow-menu-actions-97fa1cfc.js";import{P as zt,A as Gt,l as Qt,m as Yt,n as qt,o as Xt,q as Zt,r as Jt,s as te,t as ee,u as ie,v as se,w as oe,x as ae,y as re,z as ne,B as de,C as le,D as ce}from"./links-9b598b77.js";import{r as pe,s as he}from"./translations-8a80e526.js";import{P as me}from"./feeds-4612b45d.js";import{H as ue}from"./community-highlights-4f4bb401.js";import{M as ge}from"./distinguished-tags-ad178980.js";import{M as be,b as ve,c as Pe,s as ye,f as fe,d as Ae}from"./mod-verdict-47cd849f.js";import{aC as Ce}from"./age-gate-standalone-client-js-5357b0cf.js";import{g as ke}from"./postFlair-707ffbfa.js";import"./shop-gallery-data-fetcher-client-js-73ca6a07.js";const we=T({experienceName:R,content:"Pin posts to the top of your profile",source:"reddit_pro_overflow_menu_coachmark",placement:M.Left}),Ie={[t.FEED]:e.Feed,[t.FULL_BLEED_VIDEO_FEED]:e.FullBleedVideoFeed,[t.COMMENTS_PAGE]:e.CommentsPage,[t.COMMENT_TREES]:e.CommentTrees,[t.SIDEBARS]:e.Sidebars,[t.TRENDING_DISCOVERY]:e.TrendingDiscovery,[t.TRENDING_SEARCH_RESULT]:e.TrendingSearchResult,[t.BLANK_ONLY]:e.BlankOnly},Se=t=>t&&Ie[t]||null,Ee=Symbol("mixins/with-post-actions"),Re=new Set([zt.ModQueue,zt.ModNotesRail,zt.ModQueueAll,zt.ModLog]);function Te(t){if(i(t,Ee))return t;const e=U(s(t));class R extends e{constructor(){super(),this.commentCount=0,this.isCustomPost=!1,this.isPostHidden=!1,this.isPostNsfw=!1,this.isPostCommercialCommunication=!1,this.isPostSaved=!1,this.isPostSpoiler=!1,this.isPostStickied=!1,this.isPostHighlighted=!1,this.areHighlightsEnabled=!1,this.isReceivingPostReplies=!1,this.isPostFollowed=!1,this.postViewContext=null,this.isPostAwardable=!1,this.awardCount=0,this.isGenericAd=!1,this.isAdSharingEnabled=!1,this.isSurveyAd=!1,this.isRecommendedPost=!1,this.isPostEditable=!1,this.canAddOrUpdatePostFlair=!1,this.isProfilePost=!1,this.canAddAMACollaborators=!1,this.currentUserId="",this.isAdmin=!1,this.isLoggedIn=!1,this.isDesktopViewport=!1,this.isPdpAd=!1,this.impressionId="",this.isPremiumAdOverflowEnabled=!1,this.isReportableAd=!1,this.isShoppingAd=!1,this.isHideAdEnabled=!1,this.itemState=be.UNMODERATED,this.isPostDeleted=!1,this.isPostRemoved=!1,this.isPostLocked=!1,this.isReportingIgnored=!1,this.postHasReports=!1,this.postHasRemovalReason=!1,this.isSpamFilteredPost=!1,this.isModerator=!1,this.canActionPosts=!1,this.isPromoteablePost=!1,this.hasLoadedPromotedPostAnalytics=!1,this.hasPromotedPostAnalytics=!1,this.promotedAdAccounts=[],this.i18nFeedbackEligible=!1,this.translationContextValue=l,this.isImmersiveVisit=!1,this.isMtSeoVisit=!1,this.showProfilePinPostCoachmark=!1,this.isAma=!1,this.isAmaHost=!1,this.startsAt=new Date,this.endsAt=new Date,this.amaState=Gt.Scheduled,this.modActionsController=null,this.awardController=new St(this,{getThingId:()=>this.postId,getAwardPromoConfig:()=>({experience:this.awardPromoExperience,id:this.awardPromoId,type:this.awardPromoType}),onAward:()=>this.awardCount++}),this.clickAwardButton=()=>{const t=Ut.setCorrelationId(),e=Ut.setPostType(this.postType);this.trackEvent(Tt({awardId:this.awardId,thingId:this.postId,subredditId:this.subredditId,correlationId:t,postType:e})),this.awardController.activateDialog()},this._activateFeature=async t=>{await c(t)},this.handleCommentsClick=()=>{this.dispatchEvent(new Event(Mt,{bubbles:!0}))},this.handlePostShareClick=t=>{if(this.isAllowedEvent(t))if(!this.isGenericAd||this.isAdSharingEnabled)this.dispatchEvent(new Event(xt,{bubbles:!0})),this.isDesktopViewport?this.handleDesktopShareClick(t):this.handleMobileShareClick(t);else{const t=p("faceplate-alert",{level:h.notice,message:"Sharing has been disabled for this post"});this.dispatchEvent(t)}},this.handlePostUpdate=({postId:t,action:e,value:i})=>{if(t===this.postId)switch(e){case Ft.addRemovalReason:this.postHasRemovalReason=i;break;case Ft.approve:case Ft.approveOptimistic:this.itemState=i?be.APPROVED:be.UNMODERATED;break;case Ft.remove:case Ft.confirmRemoval:case Ft.removeOptimistic:case Ft.confirmRemovalOptimistic:this.itemState=i?be.REMOVED:be.UNMODERATED;break;case Ft.removeAsSpam:case Ft.removeAsSpamOptimistic:this.itemState=i?be.SPAM:be.UNMODERATED;break;case Ft.distinguishAsAdmin:this.distinguishedAs=i?"ADMIN":void 0;break;case Ft.distinguishAsMod:this.distinguishedAs=i?"MODERATOR":void 0;break;case Ft.delete:this.isPostDeleted=i;break;case Ft.follow:this.isPostFollowed=i;break;case Ft.updateSendReplies:this.isReceivingPostReplies=i;break;case Ft.hide:this.isPostHidden=i;break;case Ft.ignoreReports:this.isReportingIgnored=i;break;case Ft.lock:this.isPostLocked=i;break;case Ft.markAsCommercialCommunication:this.isPostCommercialCommunication=i;break;case Ft.markAsNsfw:this.isPostNsfw=i;break;case Ft.markAsSpoiler:this.isPostSpoiler=i;break;case Ft.save:this.isPostSaved=i;break;case Ft.sticky:this.isPostStickied=i;break;case Ft.updateHighlightedPost:this.isPostHighlighted=i}},this.getIsTranslationActive=()=>{const t=m();return"boolean"==typeof this.translationOverrideActive?this.translationOverrideActive:t||!!this.translationContextValue?.isTranslationActive},this.handlePostTranslationOverride=t=>{(t.isContextUpdateEvent||t.id===this.postId&&"PDP_OVERFLOW_MENU"!==t.source)&&(this.translationOverrideActive=t.isTranslationActive)},this.togglePostTranslationOverride=()=>{const t=this.getIsTranslationActive(),e={id:this.postId,isTranslationActive:!t,pageType:this.postViewContext===zt.CommentsPage?"PDP":"FEED",source:"PDP_OVERFLOW_MENU"};this.pubsub.publish(u.I18nPostTranslationOverride,e),this.translationOverrideActive=!t,this.trackEvent(pe({post:{id:this.postId},isImmersiveTranslationsActive:!!this.translationContextValue?.isTranslationActive,isPostTranslated:t,isPostTranslatedAfterClick:!t,isImmersiveVisit:this.isImmersiveVisit,isMtSeoVisit:this.isMtSeoVisit}))},this.onMenuOpened=()=>{this.i18nTranslationOverrideEligible&&this.trackEvent(he({post:{id:this.postId},isImmersiveTranslationsActive:!!this.translationContextValue?.isTranslationActive,isPostTranslated:this.getIsTranslationActive(),isImmersiveVisit:this.isImmersiveVisit,isMtSeoVisit:this.isMtSeoVisit}))},this.onReportClick=t=>{const{postId:e,authorName:i,authorId:s,isCustomPost:o}=this;this.isLoggedIn?this.pubsub.publish(u.ReportFlowInit,{thingId:e||"",authorName:i||"",authorId:s||"",triggerElement:t.target}):this.trackEvent(Qt(this.postViewContext)),o&&this.dispatchEvent(p("capture-devplatform-snapshot"))},this.onReportAdClick=t=>{const{postId:e,authorName:i,authorId:s,isHideAdEnabled:o}=this;if(this.isPdpAd&&!this.impressionId){const t=new URL(location.href).searchParams.get(g)||"";this.impressionId=t}this.isLoggedIn?this.pubsub.publish(u.ReportFlowInit,{thingId:(this.impressionId?`ad_${this.impressionId}_${e}`:e)||"",authorName:i||"",authorId:s||"",triggerElement:t.target,onCloseCallback:o?()=>this.onAdHideClick("report_click"):void 0}):this.trackEvent(Qt(this.postViewContext))},this.buildAdOverflowMenu=t=>Yt({post:{id:this.postId,subreddit_id:this.subredditId,promoted:!0,nsfw:!1},user_hide_ad:{hide_ad_caller:t},ad_metadata:{impression_id:this.impressionId,placement:this.placement}}),this.onAdHideClick=async t=>{if(this.isShoppingAd)return;this.trackEvent(this.buildAdOverflowMenu(t));const{postId:e,placement:i,isPdpAd:s}=this;if(s&&!this.impressionId){const t=new URL(location.href).searchParams.get(g)||"";this.impressionId=t}const o={postID:e,impressionID:this.impressionId,placement:Se(i),eventAt:(new Date).toISOString()},a={postId:e,action:Ft.hide,value:!0,impressionId:this.impressionId};this.pubsub.publish(u.AdUpdated,a);try{await Dt(o);const t=p("faceplate-alert",{level:h.notice,message:"Ad hidden"});this.dispatchEvent(t)}catch(t){let e;e=t instanceof Error&&t?.message===Ot?p("faceplate-alert",{level:h.error,cause:"uncategorized",message:"You have reached your daily limit for hiding ads."}):p("faceplate-alert",{level:h.error,cause:"uncategorized",message:"Unable to hide ad"}),this.dispatchEvent(e)}},this.onAboutThisAdClick=t=>{const{postId:e,isPdpAd:i,impressionId:s,placement:o}=this,a=(i?this.closest("shreddit-ad-post")?.adUserTargeting:this.adUserTargetingInfo)||{},r={},{gender:n,interests:d,locations:l,targetingCriteria:c}=a;r.gender=n?`${n}`:"",r.interests=d&&d.length>0?`${d.toString()}`:"",r.locations=l&&l.length>0?`${l.join("-")}`:"",r.targeting_criteria=c&&c.length>0?`${c.toString()}`:"",this.pubsub.publish(u.DsaTransparencyModal,{postId:e||"",impressionId:(i?this.closest("shreddit-ad-post")?.impressionId:s)||"",adUserTargetingParams:r,placement:o||"",target:t.target})},this.handleShowFewerClick=async()=>{this.trackEvent(qt(this.postViewContext,{post:{id:this.postId,subreddit_id:this.subredditId,...this.recommendationSubredditId?{recommendation_source_subreddit_id:this.recommendationSubredditId}:{},...this.recommendationSubredditName?{recommendation_source_subreddit_name:this.recommendationSubredditName}:{},...this.recommendationSource?{recommendation_source:this.recommendationSource.toLowerCase()}:{}}}));const{subredditId:t,subredditPrefixedName:e}=this;if(!t||!e)return;const i=await this.updateRecommendationPreferences(t,"ADD");if(i?.data?.updateRecommendationPreferences?.ok){const t=p("faceplate-alert",{level:h.success,message:`${e} won't be recommended anymore`,namedContent:{action:x` ${b({size:v.Small,children:"Undo",appearance:"secondary",attributes:{onclick:this.undoShowFewer}})} `}});this.dispatchEvent(t)}else this.handleSubredditSuggestionChangeError()},this.undoShowFewer=async()=>{const{subredditId:t,subredditPrefixedName:e}=this;if(!t||!e)return;const i=await this.updateRecommendationPreferences(t,"REMOVE");if(i?.data?.updateRecommendationPreferences?.ok){const t=p("faceplate-alert",{level:h.success,message:`We will continue to suggest posts from ${e}`});this.dispatchEvent(t)}else this.handleSubredditSuggestionChangeError()},this.getParentPost=()=>this.closest("shreddit-post")??this.closest("shreddit-ad-post"),this.pubsub=new P(this),this.reloader=new Me,this.promotePostActionsController=new Et(this),this.startEndAmaActionsController=new Rt(this)}connectedCallback(){super.connectedCallback(),"enabled"===window.CLIENT_EXPERIMENTS?.shreddit_pdp_no_mod_js_lo?this.isModerator&&this.initModActionsController():this.initModActionsController(),this.pubsub.subscribe(u.PostUpdated,this.handlePostUpdate),this.pubsub.subscribe(u.I18nPostTranslationOverride,this.handlePostTranslationOverride,!1)}async initModActionsController(){const{ModActionsController:t}=await import("./mod-actions-controller-7ff911c0.js").then((function(t){return t.m}));this.modActionsController??(this.modActionsController=new t(this,{getThingIdFn:()=>this.postId,getUserIdFn:()=>this.currentUserId}))}disconnectedCallback(){this.pubsub.unsubscribe(u.PostUpdated,this.handlePostUpdate),this.pubsub.unsubscribe(u.I18nPostTranslationOverride,this.handlePostTranslationOverride),super.disconnectedCallback()}get isProfileFeed(){const{postViewContext:t}=this;return t===zt.ProfileFeed2}get isFeedPost(){const{postViewContext:t}=this;return t&&Xt(t)}get isModQueue(){const{postViewContext:t}=this;return!!t&&Re.has(t)}get isUserOP(){const{authorId:t,currentUserId:e}=this;return!(!t||!e||t.toLowerCase()!==e.toLowerCase())}get isAd(){return this.isGenericAd||this.isSurveyAd||this.isPdpAd}get isPostDistinguishedAsMod(){return"MODERATOR"===this.distinguishedAs}get isPostDistinguishedAsAdmin(){return"ADMIN"===this.distinguishedAs}getDefaultActions(){const{postId:t,isAd:e,isReportableAd:i,isShoppingAd:s,isRecommendedPost:o,isPostEditable:a,isFeedPost:r,canAddOrUpdatePostFlair:n,canAddAMACollaborators:d,isSurveyAd:l,hasLoadedPromotedPostAnalytics:c,isPromoteablePost:p,isAma:h,isAmaHost:m,postViewContext:g,isCustomPost:b,isPremiumAdOverflowEnabled:v}=this,P=i&&!s&&this.isHideAdEnabled;return{startEndAma:{id:"startEndAma",label:this.amaState===Gt.Live?"End AMA":"Start AMA",isUserEligible:()=>g===zt.CommentsPage&&h&&m&&this.amaState!==Gt.Ended,leadingIconRenderer:F,onClick:()=>this.startEndAmaActionsController.handleClick()},aboutThisAd:{id:"aboutThisAd",label:"About this ad",isUserEligible:()=>e&&!l,leadingIconRenderer:D,onClick:this.onAboutThisAdClick},premiumUpsell:{id:"premiumUpsell",label:"Tired of ads?",isUserEligible:()=>e&&v,leadingIconRenderer:O,onClick:()=>{},href:"/premium?referrerId=ad_overflow",target:"_blank"},comments:{id:"comments",label:y({count:this.commentCount,one:x`<faceplate-number number="${this.commentCount}" pretty></faceplate-number> comment`,few:x`<faceplate-number number="${this.commentCount}" pretty></faceplate-number> comments`,many:x`<faceplate-number number="${this.commentCount}" pretty></faceplate-number> comments`,other:x`<faceplate-number number="${this.commentCount}" pretty></faceplate-number> comments`}),shortLabel:x`<faceplate-number number="${this.commentCount}" pretty></faceplate-number>`,leadingIconRenderer:N,isUserEligible:()=>!0,onClick:this.handleCommentsClick,href:this.permalink,target:this.pdpTarget},award:{id:"award",label:this.awardCount?y({count:this.awardCount,one:x`<faceplate-number number="${this.awardCount}" pretty></faceplate-number> award`,few:x`<faceplate-number number="${this.awardCount}" pretty></faceplate-number> awards`,many:x`<faceplate-number number="${this.awardCount}" pretty></faceplate-number> awards`,other:x`<faceplate-number number="${this.awardCount}" pretty></faceplate-number> awards`}):"Award",leadingIconRenderer:_,isUserEligible:()=>!!this.isPostAwardable,onClick:this.clickAwardButton},share:{id:"share",label:"Share",leadingIconRenderer:B,isUserEligible:()=>!0,onClick:this.handlePostShareClick},copyLink:{id:"copyLink",label:"Copy link",leadingIconRenderer:L,isUserEligible:()=>!0,onClick:this.handleCopyLinkClick},crosspost:{id:"crosspost",label:"Crosspost",leadingIconRenderer:V,isUserEligible:()=>!e&&this.isCrosspostable,onClick:this.handleCrosspostClick},embed:{id:"embed",label:"Embed",leadingIconRenderer:H,isUserEligible:()=>!e&&this.isEmbeddable,onClick:this.handleEmbedClick},showFewer:{id:"showFewer",label:"Show fewer posts like this",leadingIconRenderer:j,isUserEligible:()=>this.isLoggedIn&&o&&!e,onClick:this.handleShowFewerClick},edit:{id:"edit",label:"Edit post",disabled:b,leadingIconRenderer:$,isUserEligible:()=>a&&!e,description:b?"Custom posts may not be edited.":"",onClick:()=>{this.trackEvent(Zt(this.postViewContext)),t&&(r?this.redirectToPDP():this.pubsub.publish(u.PostUpdated,{postId:t,action:Ft.edit,value:!0}))}},amaCollaborators:{id:"amaCollaborators",label:"Add Co-hosts",leadingIconRenderer:W,isUserEligible:()=>g===zt.CommentsPage&&this.isUserOP&&d,onClick:async()=>{if(!t)return;let e=this.getAddAmaCollaboratorsDialog();e||(await this._activateFeature({name:f,queryParams:{postId:t,isLoggedin:this.isLoggedIn},renderMode:A.Contents}),e=this.getAddAmaCollaboratorsDialog()),e?.showModal()}},editPostFlair:{id:"editPostFlair",label:"Edit post flair",leadingIconRenderer:K,isUserEligible:()=>this.isUserOP&&n&&!e,onClick:async()=>{if(t){let e=this.getUpdatePostFlairDialog();e||(await this._activateFeature({name:C,queryParams:{selectedIds:t,isLoggedin:this.isLoggedIn},renderMode:A.Contents}),e=this.getUpdatePostFlairDialog()),e?.showModal()}this.trackEvent(Jt(this.postViewContext))}},save:{id:"save",label:Ue("Save","Remove from saved",this.isPostSaved),leadingIconRenderer:Ue(G,z,this.isPostSaved),isUserEligible:()=>this.isLoggedIn&&!e,onClick:async()=>{this.trackEvent(te(this.postViewContext)),await this.onToggleMenuItemClick({updateFunction:Nt,updateKey:Ft.save,previousState:this.isPostSaved,successText:"Post saved",errorText:"Unable to save post",toggleSuccessText:"Removed from saved",toggleErrorText:"Unable to remove from saved"})}},translationSetting:{id:"translationSetting",label:Ue("Translate","Show original",this.getIsTranslationActive()),leadingIconRenderer:Ue(Y,Q,this.getIsTranslationActive()),isUserEligible:()=>!!this.i18nTranslationOverrideEligible,onClick:this.togglePostTranslationOverride},translationFeedback:{id:"translationFeedback",label:"Give translation feedback",leadingIconRenderer:q,isUserEligible:()=>this.i18nFeedbackEligible,onClick:()=>{const t=new CustomEvent(k,{bubbles:!0,composed:!0,detail:{postId:this.postId}});this.dispatchEvent(t)}},follow:{id:"follow",label:Ue("Follow post","Unfollow post",this.isPostFollowed),leadingIconRenderer:Ue(Z,X,this.isPostFollowed),isUserEligible:()=>this.isLoggedIn&&!e&&!this.isUserOP,onClick:async()=>{this.trackEvent(ee(this.postViewContext,this.isPostFollowed)),await this.onToggleMenuItemClick({updateFunction:_t,updateKey:Ft.follow,previousState:this.isPostFollowed,successText:"Post followed!",errorText:"Failed to follow post.",toggleSuccessText:"Post unfollowed!",toggleErrorText:"Failed to unfollow post."})}},pinToProfile:{id:"pinToProfile",label:Ue("Pin Post To Profile","Unpin Post From Profile",this.isPostStickied),leadingIconRenderer:Ue(tt,J,this.isPostStickied),isUserEligible:()=>this.isLoggedIn&&this.isProfileFeed&&this.isUserOP&&!e,onClick:async()=>{this.trackEvent(this.isPostStickied?ie(this.postViewContext):se(this.postViewContext)),await this.onToggleStickyMenuClick()}},hide:{id:"hide",label:Ue("Hide","Remove from hidden",this.isPostHidden),leadingIconRenderer:Ue(j,et,this.isPostHidden),isUserEligible:()=>this.isLoggedIn&&(!e||P)&&!this.isModQueue,onClick:()=>e?this.onAdHideClick("hide_click"):this.onHideClick()},report:{id:"report",label:"Report",isUserEligible:()=>!this.isUserOP&&(!e||i),leadingIconRenderer:it,onClick:e?this.onReportAdClick:this.onReportClick},delete:{id:"delete",label:"Delete",leadingIconRenderer:st,isUserEligible:()=>this.isLoggedIn&&this.isUserOP&&!e,onClick:async()=>{this.trackEvent(oe(this.postViewContext)),await this._activateFeature({name:w});const e=document.getElementById(me);e?.openModalForPost(t)}},adminDistinguish:{id:"adminDistinguish",label:Ue("Show admin label","Hide admin label",this.isPostDistinguishedAsAdmin),leadingIconRenderer:Ue(at,ot,this.isPostDistinguishedAsAdmin),isUserEligible:()=>this.isLoggedIn&&this.isUserOP&&this.isAdmin&&!e,onClick:async()=>await this.onToggleMenuItemClick({updateFunction:Bt,updateKey:Ft.distinguishAsAdmin,previousState:this.isPostDistinguishedAsAdmin,successText:"Labelled as an admin",errorText:"Unable to show admin label",toggleSuccessText:"Unlabelled as an admin",toggleErrorText:"Unable to remove admin label"})},spoilerTag:{id:"spoilerTag",label:Ue("Add spoiler tag","Remove spoiler tag",this.isPostSpoiler),leadingIconRenderer:Ue(nt,rt,this.isPostSpoiler),isUserEligible:()=>this.isLoggedIn&&this.isUserOP&&!e,onClick:async()=>{this.trackEvent(ae({markedAsSpoiler:!this.isPostSpoiler,viewContext:this.postViewContext})),await this.onToggleMenuItemClick({updateFunction:Lt,updateKey:Ft.markAsSpoiler,previousState:this.isPostSpoiler,successText:"Spoiler tag added",errorText:"Unable to add spoiler tag",toggleSuccessText:"Spoiler tag removed",toggleErrorText:"Unable to remove spoiler tag"})}},nsfwTag:{id:"nsfwTag",label:Ue("Add NSFW tag","Remove NSFW tag",this.isPostNsfw),leadingIconRenderer:Ue(lt,dt,this.isPostNsfw),isUserEligible:()=>this.isLoggedIn&&this.isUserOP&&!e,onClick:async()=>{this.trackEvent(re({markedAsNsfw:!this.isPostNsfw,viewContext:this.postViewContext})),await this.onToggleMenuItemClick({updateFunction:Vt,updateKey:Ft.markAsNsfw,previousState:this.isPostNsfw,successText:"NSFW tag added",errorText:"Unable to add NSFW tag",toggleSuccessText:"NSFW tag removed",toggleErrorText:"Unable to remove NSFW tag"})}},brandAffiliate:{id:"brandAffiliate",label:Ue("Mark as brand affiliate","Unmark as brand affiliate",this.isPostCommercialCommunication),leadingIconRenderer:Ue(pt,ct,this.isPostCommercialCommunication),isUserEligible:()=>this.isLoggedIn&&this.isUserOP&&!e,onClick:async()=>{this.trackEvent(ne({markedAsBrandAffiliate:!this.isPostCommercialCommunication,viewContext:this.postViewContext})),await this.onToggleMenuItemClick({updateFunction:Ht,updateKey:Ft.markAsCommercialCommunication,previousState:this.isPostCommercialCommunication,successText:"Marked as brand affiliate",errorText:"Unable to mark as brand affiliate",toggleSuccessText:"Unmarked as brand affiliate",toggleErrorText:"Unable to unmark as brand affiliate"}),this.dispatchEvent(new CustomEvent(de,{bubbles:!0}))}},replyNotifs:{id:"replyNotifs",label:Ue("Turn on reply notifications","Turn off reply notifications",this.isReceivingPostReplies),leadingIconRenderer:Ue(Z,ht,this.isReceivingPostReplies),isUserEligible:()=>this.isLoggedIn&&this.isUserOP&&!e,onClick:async()=>{this.trackEvent(le({turnNotificationsOn:!this.isReceivingPostReplies,viewContext:this.postViewContext})),await this.onToggleMenuItemClick({updateFunction:jt,updateKey:Ft.updateSendReplies,previousState:this.isReceivingPostReplies,successText:"Reply notifications turned on",errorText:"Unable to turn on reply notifications",toggleSuccessText:"Reply notifications turned off",toggleErrorText:"Unable to turn off reply notifications"})}},promotePost:{id:"promotePost",label:"Promote Post",isUserEligible:()=>!!p,leadingIconRenderer:mt,onClick:this.promotePostActionsController.handleClick,disabled:!c}}}getModActions(){return{approve:{id:"approve",label:"Approve",leadingIconRenderer:ut,isUserEligible:()=>this.isModerator&&this.canActionPosts&&ve(this.itemState),onClick:this.modActionsController?.handleApproveContent??(()=>{})},remove:{id:"remove",label:"Remove",leadingIconRenderer:gt,isUserEligible:()=>this.isModerator&&this.canActionPosts&&Pe(this.itemState),onClick:this.modActionsController?.handleRemoveContent??(()=>{})},confirmRemoval:{id:"confirmRemoval",label:"Confirm Removal",leadingIconRenderer:bt,isUserEligible:()=>this.isModerator&&this.canActionPosts&&ye(this.itemState,this.isSpamFilteredPost),onClick:this.modActionsController?.handleConfirmRemoval??(()=>{})},addRemovalReason:{id:"addRemovalReason",label:"Add Removal Reason",leadingIconRenderer:vt,isUserEligible:()=>this.isModerator&&this.canActionPosts&&fe(this.itemState,this.postHasRemovalReason,this.isSpamFilteredPost,this.isProfilePost),onClick:this.modActionsController?.handleAddRemovalReason??(()=>{})},removeAsSpam:{id:"removeAsSpam",label:"Mark as Spam",leadingIconRenderer:Pt,isUserEligible:()=>this.isModerator&&this.canActionPosts&&Ae({moderationState:this.itemState,isSpamFilteredPost:this.isSpamFilteredPost,isRemoved:this.isPostRemoved}),onClick:this.modActionsController?.handleRemoveContentAsSpam??(()=>{})},ignoreReports:{id:"ignoreReports",label:Ue("Ignore reports and approve","Unignore reports",this.isReportingIgnored),leadingIconRenderer:Ue(ft,yt,this.isReportingIgnored),isUserEligible:()=>this.isModerator&&this.canActionPosts,onClick:()=>{this.isReportingIgnored?this.modActionsController?.handleUnignoreReports():(this.modActionsController?.handleIgnoreReports(),this.modActionsController?.handleApproveContent())}},editPostFlairMod:{id:"editPostFlairMod",label:"Edit post flair",leadingIconRenderer:K,isUserEligible:()=>this.isModerator&&this.canAddOrUpdatePostFlair,onClick:this.modActionsController?.handleOpenEditPostFlairModal??(()=>{})},lock:{id:"lock",label:Ue("Lock comments","Unlock comments",this.isPostLocked),leadingIconRenderer:Ue(Ct,At,this.isPostLocked),isUserEligible:()=>this.isModerator&&this.canActionPosts,onClick:this.modActionsController?._getHandleLockedToggle(this.isPostLocked?ge.Unlock:ge.Lock)??(()=>{})},sticky:{id:"sticky",label:Ue("Sticky post","Unsticky post",this.isPostStickied),leadingIconRenderer:Ue(tt,J,this.isPostStickied),isUserEligible:()=>this.isModerator&&this.canActionPosts&&!this.areHighlightsEnabled,onClick:this.modActionsController?._getHandleStickyToggle(this.isPostStickied?ge.Unsticky:ge.Sticky)??(()=>{})},highlight:{id:"highlight",label:Ue("Add to highlights","Remove from highlights",this.isPostHighlighted),leadingIconRenderer:Ue(tt,J,this.isPostHighlighted),isUserEligible:()=>this.isModerator&&this.canActionPosts&&this.areHighlightsEnabled&&!!this.postViewContext&&ue.has(this.postViewContext),onClick:this.isPostHighlighted?this.modActionsController?._getHandleRemoveFromHighlights()??(()=>{}):this.modActionsController?._getHandleAddToHighlights()??(()=>{})},nsfwTagMod:{id:"nsfwTagMod",label:Ue("Add NSFW tag","Remove NSFW tag",this.isPostNsfw),leadingIconRenderer:Ue(lt,dt,this.isPostNsfw),isUserEligible:()=>this.isModerator&&this.canActionPosts,onClick:this.modActionsController?._getHandleMarkNsfwToggle(this.isPostNsfw?ge.UnmarkNsfw:ge.MarkNsfw)??(()=>{})},spoilerTagMod:{id:"spoilerTagMod",label:Ue("Add spoiler tag","Remove spoiler tag",this.isPostSpoiler),leadingIconRenderer:Ue(nt,rt,this.isPostSpoiler),isUserEligible:()=>this.isModerator&&this.canActionPosts,onClick:this.modActionsController?._getHandleMarkSpoilerToggle(this.isPostSpoiler?ge.UnmarkSpoiler:ge.MarkSpoiler)??(()=>{})},crowdControl:{id:"crowdControl",label:"Adjust crowd control",leadingIconRenderer:kt,isUserEligible:()=>this.isModerator&&this.canActionPosts,onClick:this.modActionsController?.handleAdjustCrowdControl??(()=>{})},distinguishAsMod:{id:"distinguishAsMod",label:Ue("Show mod label","Hide mod label",this.isPostDistinguishedAsMod),leadingIconRenderer:Ue(It,wt,this.isPostDistinguishedAsMod),isUserEligible:()=>this.isUserOP&&this.isModerator&&this.canActionPosts,onClick:this.modActionsController?._getHandleDistinguishToggle(this.isPostDistinguishedAsMod?ge.Undistinguish:ge.Distinguish)??(()=>{})}}}async onToggleMenuItemClick({updateFunction:t,previousState:e,updateKey:i,successText:s,errorText:o,toggleSuccessText:a,toggleErrorText:r}){const{postId:n}=this;if(n)try{const o=await t(n,e),r={postId:n,action:i,value:o};if(this.pubsub.publish(u.PostUpdated,r),s&&a){const t=p("faceplate-alert",{level:h.success,message:o?s:a});this.dispatchEvent(t)}}catch(t){if(o&&r){const i=p("faceplate-alert",{level:h.error,message:e?r:o,cause:I(t)});this.dispatchEvent(i)}}}async onHideClick(){this.trackEvent(ce(this.postViewContext)),await this.onToggleMenuItemClick({updateFunction:$t,updateKey:Ft.hide,previousState:this.isPostHidden,successText:"Post hidden",errorText:"Unable to hide post",toggleSuccessText:"Removed from hidden",toggleErrorText:"Unable to unhide post"})}getUpdatePostFlairDialog(){return document.getElementById(ke(this.postId))}getAddAmaCollaboratorsDialog(){return document.getElementById(Ce(this.postId))}async onToggleStickyMenuClick(){const{postId:t}=this;if(!t)return;const e=this.getNumberOfStickiedPosts(),i=!this.isPostStickied;if(e>=4&&i){const t=p("faceplate-alert",{level:h.notice,message:"You can only pin 4 posts to the top of your profile."});this.dispatchEvent(t)}else try{await Wt({postId:t,sticky:i,position:null,toProfile:this.isProfileFeed}),this.reloader.reload()}catch(t){const e=i?"Could not pin post":"Could not unpin post",s=p("faceplate-alert",{level:h.error,cause:"uncategorized",message:e});this.dispatchEvent(s)}}getNumberOfStickiedPosts(){return this.getParentPost()?.parentElement?.querySelectorAll("shreddit-post[is-stickied]").length??0}async updateRecommendationPreferences(t,e){return S({operation:E.UpdateRecommendationPreferences,variables:{input:{dislikedSubredditPreference:{action:e,subredditId:t}}}})}handleSubredditSuggestionChangeError(){const t=p("faceplate-alert",{level:h.error,cause:"uncategorized",message:"Error updating suggested subreddits"});this.dispatchEvent(t)}redirectToPDP(){const t=new URLSearchParams(window.location.search);t.set(Kt,"true"),window.location.href=`${this.permalink}?${t}`}}return R[Ee]=!0,o([a({type:String,attribute:"post-id"})],R.prototype,"postId",void 0),o([a({type:String,attribute:"post-type"})],R.prototype,"postType",void 0),o([a({type:String,attribute:"author-id"})],R.prototype,"authorId",void 0),o([a({type:String,attribute:"author-name"})],R.prototype,"authorName",void 0),o([a({type:String,attribute:"subreddit-id"})],R.prototype,"subredditId",void 0),o([a({type:String,attribute:"subreddit-prefixed-name"})],R.prototype,"subredditPrefixedName",void 0),o([a({type:Number,attribute:"comment-count"})],R.prototype,"commentCount",void 0),o([a({type:String,attribute:"permalink"})],R.prototype,"permalink",void 0),o([a({type:Boolean,attribute:"is-custom-post"})],R.prototype,"isCustomPost",void 0),o([a({type:String,attribute:"distinguished-as",reflect:!0})],R.prototype,"distinguishedAs",void 0),o([a({type:Boolean,attribute:"is-post-hidden",reflect:!0})],R.prototype,"isPostHidden",void 0),o([a({type:Boolean,attribute:"is-post-nsfw",reflect:!0})],R.prototype,"isPostNsfw",void 0),o([a({type:Boolean,attribute:"is-post-commercial-communication",reflect:!0})],R.prototype,"isPostCommercialCommunication",void 0),o([a({type:Boolean,attribute:"is-post-saved",reflect:!0})],R.prototype,"isPostSaved",void 0),o([a({type:Boolean,attribute:"is-post-spoiler",reflect:!0})],R.prototype,"isPostSpoiler",void 0),o([a({type:Boolean,attribute:"is-post-stickied",reflect:!0})],R.prototype,"isPostStickied",void 0),o([a({type:Boolean,attribute:"is-post-highlighted"})],R.prototype,"isPostHighlighted",void 0),o([a({type:Boolean,attribute:"highlights-enabled"})],R.prototype,"areHighlightsEnabled",void 0),o([a({type:Boolean,attribute:"is-receiving-post-replies",reflect:!0})],R.prototype,"isReceivingPostReplies",void 0),o([a({type:Boolean,attribute:"is-post-followed",reflect:!0})],R.prototype,"isPostFollowed",void 0),o([a({type:String,attribute:"post-view-context"})],R.prototype,"postViewContext",void 0),o([a({type:Boolean,attribute:"is-post-awardable",reflect:!0})],R.prototype,"isPostAwardable",void 0),o([a({type:Number,attribute:"award-count",reflect:!0})],R.prototype,"awardCount",void 0),o([a({type:String,attribute:"award-id"})],R.prototype,"awardId",void 0),o([a({type:Boolean,attribute:"is-ad"})],R.prototype,"isGenericAd",void 0),o([a({type:Boolean,attribute:"is-ad-sharing-enabled"})],R.prototype,"isAdSharingEnabled",void 0),o([a({type:Boolean,attribute:"is-survey-ad"})],R.prototype,"isSurveyAd",void 0),o([a({type:Boolean,attribute:"is-recommended-post"})],R.prototype,"isRecommendedPost",void 0),o([a({type:String,attribute:"recommendation-source"})],R.prototype,"recommendationSource",void 0),o([a({type:String,attribute:"recommendation-subreddit-id"})],R.prototype,"recommendationSubredditId",void 0),o([a({type:String,attribute:"recommendation-subreddit-name"})],R.prototype,"recommendationSubredditName",void 0),o([a({type:Boolean,attribute:"is-post-editable"})],R.prototype,"isPostEditable",void 0),o([a({type:Boolean,attribute:"can-add-or-update-post-flair"})],R.prototype,"canAddOrUpdatePostFlair",void 0),o([a({type:Boolean,attribute:"is-profile-post"})],R.prototype,"isProfilePost",void 0),o([a({type:Boolean,attribute:"can-add-ama-collaborators"})],R.prototype,"canAddAMACollaborators",void 0),o([a({type:String,attribute:"current-user-id"})],R.prototype,"currentUserId",void 0),o([a({type:Boolean,attribute:"is-admin"})],R.prototype,"isAdmin",void 0),o([a({type:Boolean,attribute:"is-logged-in"})],R.prototype,"isLoggedIn",void 0),o([a({type:Boolean,attribute:"is-desktop-viewport"})],R.prototype,"isDesktopViewport",void 0),o([a({type:String,attribute:"pdp-target"})],R.prototype,"pdpTarget",void 0),o([a({type:Object,attribute:"ad-user-targeting-info"})],R.prototype,"adUserTargetingInfo",void 0),o([a({type:Boolean,attribute:"is-pdp-ad"})],R.prototype,"isPdpAd",void 0),o([a({type:String,attribute:"impression-id"})],R.prototype,"impressionId",void 0),o([a({type:String,attribute:"placement"})],R.prototype,"placement",void 0),o([a({type:Boolean,attribute:"is-premium-ad-overflow-enabled",reflect:!0})],R.prototype,"isPremiumAdOverflowEnabled",void 0),o([a({type:Boolean,attribute:"is-reportable-ad"})],R.prototype,"isReportableAd",void 0),o([a({type:Boolean,attribute:"is-shopping-ad"})],R.prototype,"isShoppingAd",void 0),o([a({type:Boolean,attribute:"is-hide-ad-enabled"})],R.prototype,"isHideAdEnabled",void 0),o([a({type:String,attribute:"item-state",reflect:!0})],R.prototype,"itemState",void 0),o([a({type:Boolean,attribute:"is-post-deleted",reflect:!0})],R.prototype,"isPostDeleted",void 0),o([a({type:Boolean,attribute:"is-post-removed",reflect:!0})],R.prototype,"isPostRemoved",void 0),o([a({type:Boolean,attribute:"is-post-locked",reflect:!0})],R.prototype,"isPostLocked",void 0),o([a({type:Boolean,attribute:"is-reporting-ignored",reflect:!0})],R.prototype,"isReportingIgnored",void 0),o([a({type:Boolean,attribute:"post-has-reports",reflect:!0})],R.prototype,"postHasReports",void 0),o([a({type:Boolean,attribute:"post-has-removal-reason",reflect:!0})],R.prototype,"postHasRemovalReason",void 0),o([a({type:Boolean,attribute:"is-spam-filtered-post",reflect:!0})],R.prototype,"isSpamFilteredPost",void 0),o([a({type:Boolean,attribute:"is-moderator"})],R.prototype,"isModerator",void 0),o([a({type:Boolean,attribute:"can-action-posts"})],R.prototype,"canActionPosts",void 0),o([a({type:Boolean,attribute:"is-promoteable-post"})],R.prototype,"isPromoteablePost",void 0),o([r()],R.prototype,"hasLoadedPromotedPostAnalytics",void 0),o([r()],R.prototype,"hasPromotedPostAnalytics",void 0),o([r()],R.prototype,"promotedAdAccounts",void 0),o([a({type:Boolean,attribute:"i18n-feedback-eligible"})],R.prototype,"i18nFeedbackEligible",void 0),o([n({context:d,subscribe:!0}),r()],R.prototype,"translationContextValue",void 0),o([r()],R.prototype,"translationOverrideActive",void 0),o([a({type:Boolean,attribute:"i18n-translation-override-eligible"})],R.prototype,"i18nTranslationOverrideEligible",void 0),o([a({type:Boolean,attribute:"is-immersive-visit"})],R.prototype,"isImmersiveVisit",void 0),o([a({type:Boolean,attribute:"is-mt-seo-visit"})],R.prototype,"isMtSeoVisit",void 0),o([a({type:Boolean,attribute:"show-profile-pin-post-coachmark"})],R.prototype,"showProfilePinPostCoachmark",void 0),o([a({type:Boolean,attribute:"is-ama-post"})],R.prototype,"isAma",void 0),o([a({type:Boolean,attribute:"is-ama-host"})],R.prototype,"isAmaHost",void 0),o([a({type:Date,attribute:"ama-starts-at",converter:{fromAttribute:t=>new Date(t)}})],R.prototype,"startsAt",void 0),o([a({type:Date,attribute:"ama-ends-at",converter:{fromAttribute:t=>new Date(t)}})],R.prototype,"endsAt",void 0),o([a({type:String,attribute:"ama-state",reflect:!0})],R.prototype,"amaState",void 0),o([a({type:String,attribute:"award-promo-experience"})],R.prototype,"awardPromoExperience",void 0),o([a({type:String,attribute:"award-promo-id"})],R.prototype,"awardPromoId",void 0),o([a({type:String,attribute:"award-promo-type"})],R.prototype,"awardPromoType",void 0),o([r()],R.prototype,"modActionsController",void 0),R}function Ue(t,e,i){return i?e:t}class Me{constructor(){this._locationImpl=window.location}setLocationImplementation(t){this._locationImpl=t}reload(){this._locationImpl.reload()}}export{Te as W,we as p};
