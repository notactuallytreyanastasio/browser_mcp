import{t as e,_ as t,n as s,g as i,dr as r,T as n,M as a,O as o,P as d,w as c,x as p,e as l,aI as h}from"./shell-2264602c.js";import{s as m,x as u}from"./icon-82dd10b4.js";import{au as g}from"./age-gate-standalone-client-js-5357b0cf.js";import{A as b}from"./links-9b598b77.js";import{E as f,a as v}from"./overflow-menu-actions-97fa1cfc.js";function y(e,t,s=!0){return new CustomEvent(e,{composed:!0,bubbles:s,cancelable:!0,detail:t})}var R,S,P,w,I;!function(e){e[e.emergency=0]="emergency",e[e.alert=1]="alert",e[e.critical=2]="critical",e[e.error=3]="error",e[e.warning=4]="warning",e[e.notice=5]="notice",e[e.info=6]="info",e[e.success=7]="success",e[e.debug=8]="debug",e[e.none=9]="none"}(R||(R={})),function(e){e.Programmatic="programmatic",e.Eager="eager",e.Action="action",e.Intent="intent",e.Lazy="lazy",e.Preload="preload"}(S||(S={})),function(e){e.Once="once",e.Always="always"}(P||(P={})),function(e){e.Get="get",e.Post="post",e.Dialog="dialog",e.Log="log"}(w||(w={})),function(e){e.Append="append",e.Prepend="prepend",e.After="after",e.Before="before",e.Replace="replace",e.Contents="contents"}(I||(I={}));let E=class extends m{constructor(){super(...arguments),this.isReminderSet=!1,this.eventState=b.Scheduled,this.postId="",this.permalink="",this.pdpTarget="_self",this.isPdp=!1,this.isLoggedIn=!1,this.requestInProgress=!1,this.handleClickCancelReminder=()=>{this.dispatchEvent(new Event(f,{bubbles:!0})),this.cancelReminder()},this.cancelReminder=async()=>{this.isReminderSet=!1;if(await this.updatePostReminderState(r.NoReminder)){const e=y("faceplate-alert",{level:R.notice,message:"Reminder cancelled"});this.dispatchEvent(e)}else{this.isReminderSet=!0;const e="Failed to cancel reminder";this.dispatchErrorAlert(e)}},this.handleClickSetReminder=async()=>{this.dispatchEvent(new Event(v,{bubbles:!0})),this.isLoggedIn?await this.setReminder():this.dispatchEvent(y(h.follow))},this.setReminder=async()=>{this.isReminderSet=!0;if(await this.updatePostReminderState(r.Reminder)){const e=y("faceplate-alert",{level:R.success,message:"Reminder set"});this.dispatchEvent(e),this.pubsub?.publish(n.AMAPostRsvpSubscribe,{postId:this.postId})}else{this.isReminderSet=!1;const e="Failed to set reminder";this.dispatchErrorAlert(e)}},this.updatePostReminderState=async e=>{this.requestInProgress=!0;const t=await a({operation:o.UpdatePostReminderState,variables:{input:{postId:this.postId,reminderState:e}}});return this.requestInProgress=!1,!!t.data.updatePostReminderState?.ok}}connectedCallback(){super.connectedCallback(),this.pubsub=new d(this)}dispatchErrorAlert(e){const t=y("faceplate-alert",{level:R.error,cause:"uncategorized",message:e});this.dispatchEvent(t)}getButtonAttributes(){const e=this.eventState===b.Live;return e&&this.isPdp?null:e&&!this.isPdp?{text:"Join Now",appearance:"primary",href:this.permalink,target:this.pdpTarget}:this.isReminderSet&&!e?{action:this.handleClickCancelReminder,text:"Reminder set",appearance:g()?"secondary":"bordered"}:this.isReminderSet||e?null:{action:this.handleClickSetReminder,text:"Remind me",appearance:g()?"bordered":"secondary"}}render(){if(this.eventState===b.Ended)return u``;const e=this.getButtonAttributes();if(!e)return u``;const{appearance:t,action:s,text:i,href:r,target:n}=e,a=c({appearance:t,attributes:{className:"relative",onclick:s,id:"",href:r,target:n,disabled:this.requestInProgress},size:p.Small,children:i});return u`${a}`}};E.styles=[e],t([s({type:Boolean,attribute:"is-reminder-set",reflect:!0})],E.prototype,"isReminderSet",void 0),t([s({type:String,attribute:"event-state"})],E.prototype,"eventState",void 0),t([s({type:String,attribute:"post-id"})],E.prototype,"postId",void 0),t([s({type:String})],E.prototype,"permalink",void 0),t([s({type:String,attribute:"pdp-target"})],E.prototype,"pdpTarget",void 0),t([s({type:Boolean,attribute:"is-pdp"})],E.prototype,"isPdp",void 0),t([s({type:Boolean,attribute:"is-logged-in"})],E.prototype,"isLoggedIn",void 0),t([i()],E.prototype,"requestInProgress",void 0),E=t([l("ad-reminder-button")],E);
