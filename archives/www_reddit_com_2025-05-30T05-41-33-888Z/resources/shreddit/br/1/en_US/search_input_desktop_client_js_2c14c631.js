import"./faceplate-search-input-ad8da225.js";import{_ as e,e as t,a7 as s,bS as o}from"./shell-2264602c.js";import{x as r}from"./icon-82dd10b4.js";import{R as a,a as n,S as i}from"./base-793c2460.js";import"./text-input-7536667a.js";import"./filterNullish-60f7e90f.js";import"./constants-d65b7b38.js";import"./validate-image-b0892d29.js";import"./age-gate-standalone-client-js-5357b0cf.js";import"./search-results-dropdown-modifier-client-js-3f7d3b85.js";import"./post-consume-tracker-f949dd81.js";import"./links-9b598b77.js";import"./search-typeahead-expandable-section-df6cd1cc.js";import"./search-params-9b432517.js";import"./search-dynamic-id-fd96acc2.js";import"./expandable-section-header-edd4c2b3.js";import"./ad-event-tracker-f9b59b5a.js";import"./with-ad-observer-3dfd9c4c.js";import"./errors-8d0111b7.js";import"./overflow-menu-actions-97fa1cfc.js";import"./distinguished-tags-ad178980.js";import"./shreddit-dynamic-ad-link-548337a6.js";import"./suggested-search-queries-client-js-e9a5ef2a.js";import"./faceplate-expandable-section-helper-d16b871c.js";import"./faceplate-auto-height-animator-eba3f9a9.js";import"./content-tags-a35f6e45.js";import"./password-recovery-11761f51.js";let c=class extends a{constructor(){super(...arguments),this.onKeyDown=e=>{const t="Escape"===e.key,s="Tab"===e.key,o=Boolean(s&&this.shadowRoot&&this.input&&this.shadowRoot.activeElement===this.input),r=s&&!e.shiftKey;t&&e.preventDefault(),(t||o||r)&&this.handleBlur()},this.getKeyboardNavigableDropdownItems=()=>{const e=`[role="menuitem"],summary[aria-controls*="${o}"]`,t=[];return[this.suggestedSearchResultsContainer,this.recentSearchesContainer,this.trendingSearchesContainer,this.typeaheadResultsContainer].forEach((s=>{if(!s)return;s.querySelectorAll(e).forEach((e=>{const s=null!==e.offsetParent&&e.offsetHeight>0,o="SUMMARY"===e.tagName,r=e.closest("faceplate-expandable-section-helper");s&&(o||!r||r.open)&&t.push(e)}))})),t},this.handleRecentSearchTabKeyNavigation=e=>{const t=e.target.querySelector(".recent-search-item-delete-button");e.shiftKey&&e.target.className.includes("recent-search-item-delete-button")?(e.target.closest('[role="menuitem"]')?.focus(),e.preventDefault(),e.stopPropagation()):!e.shiftKey&&t&&(t.focus(),e.preventDefault(),e.stopPropagation())},this.handleDropdownKeyDown=e=>{const t=e.target.closest(`#${n}`);if("Tab"===e.key&&t)this.handleRecentSearchTabKeyNavigation(e);else if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault();const t=e.target,s=this.getKeyboardNavigableDropdownItems();let o=-1;s.forEach(((e,s)=>{e===t&&(o=s)}));const r="ArrowDown"===e.key?o+1:o-1,a=o>=0&&o<s.length?s[r]:void 0;a?a.focus():this.focusSearchInputWithArrowKeys()}}}connectedCallback(){super.connectedCallback(),this.addEventListener("keydown",this.onKeyDown)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("keydown",this.onKeyDown)}handleKeyDown(e){if(super.handleKeyDown(e),!["ArrowDown","ArrowUp"].includes(e.key))return;e.preventDefault();const t=this.getKeyboardNavigableDropdownItems();0!==t.length&&("ArrowDown"===e.key?t[0].focus():"ArrowUp"===e.key&&t[t.length-1].focus())}focusSearchInputWithArrowKeys(){const e=this.input?.shadowRoot?.querySelector("input");e?.focus();const t=e?.value.length;t&&e?.setSelectionRange(t,t)}render(){return r` <div class="reddit-search-bar rounded-[1.25rem] w-[inherit] box-border ${s({"shadow-sm":this.isFocused,"bg-neutral-background-strong":this.isFocused,"bg-secondary-background":!this.isFocused})}" data-faceplate-tracking-context="${JSON.stringify(this.searchTelemetryData)}"> <div class="${s({"pb-[.5rem]":this.showDropdown&&!this.isSearchScopeEnabled,"pb-xs":this.showDropdown&&this.isSearchScopeEnabled,"border-b-sm":this.showDropdown,"border-t-0":this.showDropdown,"border-r-0":this.showDropdown,"border-l-0":this.showDropdown,"border-solid":this.showDropdown,"border-neutral-border-weak":this.showDropdown})}"> <form autocomplete="off" class="flex relative items-center text-neutral-content-strong" @submit="${this.handleSubmit}"> ${this.renderSearchInput(!0)} </form> </div> <div class="max-h-[calc(100vh-var(--shreddit-header-height)-15px-10px)] overflow-y-auto overflow-x-hidden m-t ${s({hidden:!this.showDropdown})}" id="${i}"> ${this.renderDropdownContent(!0)} </div> </div> `}};c=e([t("reddit-search-large")],c);
