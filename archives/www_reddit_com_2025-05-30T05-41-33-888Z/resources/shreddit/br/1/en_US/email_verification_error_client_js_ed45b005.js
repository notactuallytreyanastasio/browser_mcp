import{a as t,t as e,_ as i,n as o,m as s,J as n,g as a,E as r,aP as d,aM as l,aF as h,f8 as c,hG as p,hH as u,dg as m,a7 as b,e as v}from"./shell-2264602c.js";import{a as g,s as f,x as w,$ as x,I as k}from"./icon-82dd10b4.js";import{h as y,i as V}from"./helpers-e162eb2b.js";import"./age-gate-standalone-client-js-5357b0cf.js";var B;const E=t=>t instanceof HTMLIFrameElement&&t.src.includes("recaptcha"),T=t(f);let H=B=class extends T{constructor(){super(...arguments),this.pageName="",this.withBlur=!1,this.contentHiddenTop=!1,this.contentHiddenBottom=!1,this.isVirtualKeyboardVisible=!1,this.loading=!1,this.events=new r(this),this.observer=new d(this,this),this.focusManager=new l(this,this),this.inFocusTrap=!1,this.blocking=!0,this.open=!1,this._enter=this.events.define("faceplate-enter",this.showModal),this._leave=this.events.define("faceplate-leave",this.close),this.refreshFocus=h((()=>this.focusManager.refresh()),100),this.checkForHiddenContent=()=>{if(this.content){const{scrollTop:t,scrollHeight:e,clientHeight:i}=this.content;this.contentHiddenTop=e>i&&t>0,this.contentHiddenBottom=this.isVirtualKeyboardVisible||e>i&&Math.ceil(i+t)<e}},this.handleViewport=h((()=>{const t=window.visualViewport;t&&(t.height<this.clientHeight?(this.style.paddingBottom=this.clientHeight-t.height-t.offsetTop+"px",this.isVirtualKeyboardVisible=!0):(this.style.paddingBottom="0px",this.isVirtualKeyboardVisible=!1),this.checkForHiddenContent())}),100),this.onClick=t=>{const e=t.currentTarget;e instanceof c&&"click"!==e.action&&"view"!==e.action&&(t.preventDefault(),e.trackEvent?.())}}disconnectedCallback(){super.disconnectedCallback(),this.close()}showModal(){B.isReported||this.isValidOrigin()||(this.trackEvent(y(this.pageName)),B.isReported=!0),this.trackEvent(V(this.pageName)),p().then((()=>{u.add(this),this.focusManager.focusFirst(),document.body.style.pointerEvents="auto",document.body.addEventListener("focusin",this.ignoreRecaptchaIframeFocus),document.body.addEventListener("keydown",this.ignoreRecaptchaIframeTab)})),this.addEventListener("focusable-content-loaded",this.refreshFocus),this.mutationObserver=new MutationObserver(this.refreshFocus),this.mutationObserver.observe(this,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["disabled","aria-disabled","class","hidden","slot"]}),this.resizeObserver=new ResizeObserver(this.checkForHiddenContent),this.content&&(this.resizeObserver.observe(this.content),this.content.addEventListener("scroll",this.checkForHiddenContent)),window?.visualViewport?.addEventListener("resize",this.handleViewport),window?.visualViewport?.addEventListener("scroll",this.handleViewport),this.backButtonTrackers.forEach((t=>t.addEventListener("click",this.onClick))),this.closeButtonTrackers.forEach((t=>t.addEventListener("click",this.onClick))),this.dispatchEvent(new CustomEvent(m.Open,{bubbles:!0,composed:!0})),this.open=!0}ignoreRecaptchaIframeFocus(t){E(t.target)&&t.stopPropagation()}ignoreRecaptchaIframeTab(t){"Tab"===t.key&&E(t?.target)&&t?.stopPropagation()}close(){this.open&&(window?.visualViewport?.removeEventListener("resize",this.handleViewport),window?.visualViewport?.removeEventListener("scroll",this.handleViewport),u.remove(this),this.mutationObserver?.disconnect(),this.open=!1)}_getLocation(){return window.location}isValidOrigin(){const t=this._getLocation();return!(!("IS_STORYBOOK"in window)||!window.IS_STORYBOOK)||"https:"===t.protocol&&(t.origin.endsWith(".reddit.com")||t.origin.endsWith(".snoo.dev"))}render(){const t=w`${this.isValidOrigin()?"":w` <div class="w-100 top-0 left-0 bg-danger-background text-global-white flex items-center justify-center box-border p-md"> ${x({attributes:{className:"mr-xs"},size:k.ExtraLarge})} This page was served from a non-Reddit domain. Please be extra careful. </div> `} <div class="flex justify-between items-end pt-lg pb-xs px-[var(--topbar-horizontal-padding)]"> <div class="inline-flex items-center gap-md"> <slot name="backButton"></slot> <slot name="titleGraphic"></slot> </div> <slot name="closeButton"></slot> </div>`,e={"border-t-sm":this.contentHiddenTop,"border-b-sm":this.contentHiddenBottom};return w` <div class="bg-ui-modalbackground max-w-full flex flex-col basis-full font-sans pointer-events-auto"> ${t} <slot name="title" class="inline-flex py-0 px-[var(--horizontal-padding)]"></slot> <slot name="subtitle" class="inline-flex py-0 px-[var(--horizontal-padding)]"></slot> <slot class="flex flex-col grow shrink overflow-y-auto py-0 px-[var(--horizontal-padding)] border-0 border-solid border-neutral-border ${b(e)}"></slot> ${this.loading?w`<shreddit-loading class="pointer-events-none h-[8rem]"></shreddit-loading>`:w` <slot name="primaryButton" class="inline-flex"></slot>`} </div>`}};H.isReported=!1,H.styles=[g`:host{--horizontal-padding:80px;--topbar-horizontal-padding:24px;display:flex;position:fixed;box-sizing:border-box;margin:auto;border-radius:var(--rem16);background:var(--color-ui-modalbackground);overflow:hidden;left:0;right:0;top:50%;transform:translateY(-50%);min-width:320px;width:528px;max-width:528px;min-height:400px;height:100%;max-height:664px}:host([withBlur]){box-shadow:0 0 0 max(100vw,100vh) var(--color-scrim)}slot:not([name]){transition:width .1s ease-in}::slotted([slot=primaryButton]){padding:24px var(--horizontal-padding)}@media (max-width:528px){:host{--horizontal-padding:16px;--topbar-horizontal-padding:16px;max-height:none;width:100%;max-width:none;border-radius:0;padding-bottom:0;transition:padding-bottom .2s ease-in-out}}`,e],i([o({type:String})],H.prototype,"pageName",void 0),i([o({type:Boolean})],H.prototype,"withBlur",void 0),i([s({slot:"backButton",selector:"faceplate-tracker"})],H.prototype,"backButtonTrackers",void 0),i([s({slot:"closeButton",selector:"faceplate-tracker"})],H.prototype,"closeButtonTrackers",void 0),i([n("slot:not([name])",!0)],H.prototype,"content",void 0),i([a()],H.prototype,"contentHiddenTop",void 0),i([a()],H.prototype,"contentHiddenBottom",void 0),i([a()],H.prototype,"isVirtualKeyboardVisible",void 0),i([a()],H.prototype,"loading",void 0),H=B=i([v("auth-flow-modal")],H);export{E as i};
