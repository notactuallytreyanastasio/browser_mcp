import{a as e,t,_ as s,J as a,n as o,g as i,c as n,I as r,w as l,x as c,e as d}from"./shell-2264602c.js";import"./chat-mobile-xpromo-client-js-c803f3b0.js";import{a as p,T as h}from"./faceplate-textarea-input-97dc2a34.js";import{s as m,x as u,c as b,I as f}from"./icon-82dd10b4.js";import{u as w,n as x,m as v,o as k}from"./translations-8a80e526.js";import"./app-selector-client-js-3a92da0e.js";import"./age-gate-standalone-client-js-5357b0cf.js";import"./text-input-7536667a.js";import"./filterNullish-60f7e90f.js";import"./constants-d65b7b38.js";import"./TinyGesture-89d9957c.js";const g=e(m),A="translation-feedback-modal",$="feedback-other-input";let y=class extends g{constructor(){super(...arguments),this.FEEDBACK_ANSWERS={incomprehensible:"Incomprehensible",slang:"Slang, idioms or expressions",grammar:"Grammar","tone of voice":"Tone of voice",other:"Other"},this.open=!1,this.selectedAnswers=new Set,this.otherFeedbackValue=""}async show(e){if(!this.open)return this.originMetadata=e,this.trackEvent(w({post:e.post,comment:e.comment})),this.trackEvent(x({post:e.post,comment:e.comment})),this.open=!0,this.modal?.showModal()}_close(){if(this.open)return this.trackEvent(v({post:this.originMetadata?.post,comment:this.originMetadata?.comment})),this.open=!1,this.originMetadata=void 0,this.selectedAnswers=new Set,this.otherFeedbackValue="",this.modal?.close()}handleAnswerButtonClick(e){const t=new Set(this.selectedAnswers);this.selectedAnswers.has(e)?t.delete(e):t.add(e),this.selectedAnswers=t}handleSubmit(){return this.trackEvent(k({reason:Array.from(this.selectedAnswers).join(","),survey_text:this.otherFeedbackValue,post:this.originMetadata?.post,comment:this.originMetadata?.comment})),this.dispatchEvent(n("faceplate-alert",{level:r.success,message:"Thanks for rating"})),this.open=!1,this.originMetadata=void 0,this.selectedAnswers=new Set,this.otherFeedbackValue="",this.modal?.close()}renderFeedbackBody(){return u` <span class="font-bold text-14 mb-md"> What's wrong with these translations?</span> <div class="flex flex-row gap-xs flex-wrap ${this.selectedAnswers.has("other")?"mb-md":""}"> ${Object.keys(this.FEEDBACK_ANSWERS).map((e=>{const t=e;return l({appearance:"bordered",size:c.Medium,shape:"pill",attributes:{className:"inline-flex px-sm box-border "+(this.selectedAnswers.has(t)?"bg-neutral-background-selected":""),onclick:()=>this.handleAnswerButtonClick(t)},children:u`<span class="font-semibold text-12">${this.FEEDBACK_ANSWERS[t]}</span>`})}))} </div> ${this.selectedAnswers.has("other")?u` <div class="flex w-full box-border"> <faceplate-textarea-input appearance="${p.BORDERED}" size="${h.EXPANDED}" maxlength="500" @keyup="${e=>{e.stopPropagation(),this.otherFeedbackValue=e.target.value}}" class="w-full ${$}" .value="${this.otherFeedbackValue}"> <span slot="label">Leave a comment (optional)</span> </faceplate-textarea-input> </div> `:u``} `}renderTitle(){return u` <h3 class="mb-0 mt-xs font-bold inline-flex text-18"> Translation Feedback </h3> `}renderCloseButton(){return u` ${l({attributes:{"aria-label":"Close",onclick:()=>this._close()},appearance:"secondary",leadingIcon:b({size:f.Small}),size:c.Small})} `}renderSubmitButton(){return u` <div class="flex w-full"> ${l({appearance:"primary",size:c.Large,shape:"pill",attributes:{className:"flex box-border w-full",onclick:this.handleSubmit.bind(this),disabled:0===this.selectedAnswers.size},children:u`<span class="font-semibold text-14">Submit</span>`})} </div> `}render(){return u` <faceplate-modal blocking ?open="${this.open}" class="${A} w-[350px] m:w-[640px] h-fit z-10"> <div slot="title" class="w-full m:w-fit">${this.renderTitle()}</div> <div slot="closeButton" class="flex items-center">${this.renderCloseButton()}</div> <div class="flex flex-col w-full box-border mt-lg">${this.renderFeedbackBody()}</div> <div slot="primaryButton">${this.renderSubmitButton()}</div> </faceplate-modal> `}};y.styles=[t],s([a(`faceplate-modal.${A}`,!0)],y.prototype,"modal",void 0),s([o({type:Boolean,attribute:"open"})],y.prototype,"open",void 0),s([i()],y.prototype,"selectedAnswers",void 0),s([i()],y.prototype,"otherFeedbackValue",void 0),s([i()],y.prototype,"originMetadata",void 0),y=s([d("translation-feedback-modal")],y);
