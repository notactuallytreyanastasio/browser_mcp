import{bH as t,aP as e,E as s,aJ as n,aY as o,aZ as i,aX as r,_ as a,n as c,e as h,Z as l,$ as v}from"./shell-2264602c.js";import{C as u}from"./post-consume-tracker-f949dd81.js";import{s as p}from"./icon-82dd10b4.js";import"./links-9b598b77.js";import"./age-gate-standalone-client-js-5357b0cf.js";function d(t){return t?.split(",")}function g(t){const[e,s,n]=t.split("/");return{source:e,action:s,noun:n}}function E(t,e,s){return()=>e.forEach((e=>{const{source:o,action:i,noun:r}=g(e);o&&i&&r&&n(t,{source:o,action:i,noun:r,...s})}))}class k{constructor(t,e){this.host=t,this.onChange=e,this.host.addController(this)}hostConnected(){o(this.onChange,{immediate:!0})}hostDisconnected(){i(this.onChange)}}class C{constructor(t,e){this.host=t,this.onChange=e,this.host.addController(this)}hostConnected(){r.subscribe(this.onChange)}hostDisconnected(){r.unsubscribe(this.onChange)}}const b="search-telemetry-tracker";let f=class extends p{constructor(){super(...arguments),this.trackingContext={},this.clickEventSANs=[],this.viewEventSANs=[],this.leaveEventSANs=[],this.consumeEventSANs=[],this.disabled=!1,this.controllers=[]}setupClickEventTracking(){this.controllers.push(l(this,this,E(this,this.clickEventSANs,this.trackingContext)))}setupViewEventTracking(t){t.push(E(this,this.viewEventSANs,this.trackingContext))}setupLeaveEventTracking(t){t.push(E(this,this.leaveEventSANs,this.trackingContext))}setupConsumeEventTracking(t,e){const s=this.consumeEventSANs.map((t=>new u(this,g(t))));this.controllers.push(new k(this,(t=>s.forEach((e=>e.handleDocumentVisibilityChange(t)))))),this.controllers.push(new C(this,(()=>s.forEach((t=>t.onBeforeUnloadCallback()))))),t.push((()=>s.forEach((t=>t.handleIntersectionObserverEnter())))),e.push((()=>s.forEach((t=>t.handleIntersectionObserverLeave()))))}setupEnterLeaveTracking(){const n=[],o=[];this.viewEventSANs.length&&this.setupViewEventTracking(n),this.leaveEventSANs.length&&this.setupLeaveEventTracking(o),this.consumeEventSANs.length&&this.setupConsumeEventTracking(n,o),this.controllers.push(function({host:n,target:o,enterCallback:i,leaveCallback:r,options:a}){const c=new t(n);new e(c,o,a);const h=new s(c,(()=>o));return i&&h.define("faceplate-enter",(t=>i(t))),r&&h.define("faceplate-leave",(t=>r(t))),c}({host:this,target:this,enterCallback:n.length?()=>n.forEach((t=>t())):void 0,leaveCallback:o.length?()=>o.forEach((t=>t())):void 0,options:{rootMargin:"0px"}}))}setupControllers(){this.clickEventSANs.length&&this.setupClickEventTracking(),!this.viewEventSANs.length&&this.leaveEventSANs.length&&this.consumeEventSANs.length||this.setupEnterLeaveTracking()}tearDownControllers(){for(const t of this.controllers)v(this,t);this.controllers=[]}connectedCallback(){super.connectedCallback(),this.disabled||this.setupControllers()}disconnectedCallback(){super.disconnectedCallback(),this.tearDownControllers()}updated(t){super.updated(t),t.has("disabled")&&void 0!==t.get("disabled")&&this[this.disabled?"tearDownControllers":"setupControllers"]()}createRenderRoot(){return this}};a([c({type:Object,attribute:"data-faceplate-tracking-context"})],f.prototype,"trackingContext",void 0),a([c({attribute:"click-events",converter:d})],f.prototype,"clickEventSANs",void 0),a([c({attribute:"view-events",converter:d})],f.prototype,"viewEventSANs",void 0),a([c({attribute:"leave-events",converter:d})],f.prototype,"leaveEventSANs",void 0),a([c({attribute:"consume-events",converter:d})],f.prototype,"consumeEventSANs",void 0),a([c({type:Boolean})],f.prototype,"disabled",void 0),f=a([h(b)],f);export{b as S};
