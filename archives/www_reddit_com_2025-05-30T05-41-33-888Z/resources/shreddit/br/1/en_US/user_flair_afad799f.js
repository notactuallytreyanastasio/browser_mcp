import{a as t,cK as e}from"./icon-82dd10b4.js";import{O as i,M as n,b as o,H as s}from"./shell-2264602c.js";import{ag as r}from"./age-gate-standalone-client-js-5357b0cf.js";const a={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8,padding:0},l=(t,e,i)=>{const{container:n,margin:o,padding:s,position:r,variantFlipOrder:l,positionFlipOrder:p}={container:document.documentElement.getBoundingClientRect(),...a,...i},{left:c,top:h}=e.style;e.style.left="0",e.style.top="0";const u=t.getBoundingClientRect(),d=e.getBoundingClientRect(),m={t:u.top-d.height-o,b:u.bottom+o,r:u.right+o,l:u.left-d.width-o},f={vs:u.left,vm:u.left+u.width/2+-d.width/2,ve:u.left+u.width-d.width,hs:u.top,hm:u.bottom-u.height/2-d.height/2,he:u.bottom-d.height},[g,_="middle"]=r.split("-"),b=p[g],E=l[_],{top:y,left:v,bottom:w,right:S}=n;for(const t of b){const i="t"===t||"b"===t,n=m[t],[o,r]=i?["top","left"]:["left","top"],[a,l]=i?[d.height,d.width]:[d.width,d.height],[p,c]=i?[w,S]:[S,w],[h,u]=i?[y,v]:[v,y];if(!(n<h||n+a+s>p))for(const a of E){const p=f[(i?"v":"h")+a];if(!(p<u||p+l+s>c))return e.style[r]=p-d[r]+"px",e.style[o]=n-d[o]+"px",t+a}}return e.style.left=c,e.style.top=h,null};function p(t,e=50,i={leading:!0,trailing:!0}){i={leading:!0,trailing:!0,...i};let n,o,s,r=null,a=0;const l=function(){a=i.leading?Date.now():0,r=null,s=t.apply(n,o),r||(n=o=null)};return function(...p){const c=Date.now();a||!1!==i.leading||(a=c);const h=e-(c-a);return n=this,o=p,h<=0||h>e?(r&&(clearTimeout(r),r=null),a=c,s=t.apply(n,p),r||(n=o=null)):r||!1===i.trailing||(r=setTimeout(l,h)),s}}const c=["button","link","menuitem","tab","checkbox","combobox","gridcell","application","treeitem"];class h{set popperTrigger(t){this._popperTrigger=t}get popperTrigger(){if(this._popperTrigger)return this._popperTrigger;let t=this.host.shadowRoot?.querySelector("slot[faceplate-popper-trigger]")?.assignedElements()?.[0]??null;let e=0;const i=t=>t instanceof HTMLButtonElement||t instanceof HTMLAnchorElement||c.includes(t?.getAttribute("role")??"");if(i(t))return t;for(;t&&e<5;){if(t=t?.assignedElements?t?.assignedElements()?.[0]??null:t?.children[0]??null,i(t))return t;e++}return null}get popperContent(){return this.host.shadowRoot?.querySelector("[faceplate-popper-content]")?.querySelector("slot")?.assignedElements()?.[0]??null}constructor(t,{containerElement:i=document.documentElement,scrollContainerElement:n=e().scrollContainerElement(),allowCloseByEvent:o=!0,...s}){this.status="closed",this._containerSize=null,this.containerSizeChanged=t=>{if(!this._containerSize)return!0;const e=this._containerSize;return Object.keys(t).some((i=>e[i]!==t[i]))},this.updateAriaStates=async(t=!1)=>{const e="open"===this.currentState.state,i="tooltip"===this.host.shadowRoot?.querySelector("[faceplate-popper-content]")?.getAttribute("role"),n="dialog"===this.host.shadowRoot?.querySelector("[faceplate-popper-content]")?.getAttribute("role"),o=this.popperTrigger,s=this.popperContent,r=!this._options.manualTriggerFocus&&!t&&!n&&"function"==typeof o?.focus;i||(t&&(o?.setAttribute("aria-haspopup",n?"dialog":"true"),s?.setAttribute("hidden","")),e?(s?.removeAttribute("hidden"),this.currentState.animationFinished&&await this.currentState.animationFinished,s?.openMenu?.()):(s?.setAttribute("hidden",""),s?.closeMenu?.(),r&&o?.focus()),o?.setAttribute("aria-expanded",`${e}`))},this.referenceInViewport=p((()=>{const{reference:t=null,containerElement:e=document.documentElement}=this._options;if("open"!==this.status)return!1;if(!t)return!1;const i=t.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||e.clientHeight)&&i.right<=(window.innerWidth||e.clientWidth)}),80),this.isOffscreenBottom=p((t=>{const e=t.popper?.getBoundingClientRect(),i=this._options.reference?.getBoundingClientRect();return!!e&&window.innerHeight-(i.bottom+e.height)<16}),80),this.getPosition=t=>{const e=t.position??"bottom";return"open"===this.status?e:this.popper&&this.isOffscreenBottom(t)&&e?.includes("bottom")?e.replace("bottom","top"):t.position},this.reposition=()=>{this.referenceInViewport()?this.updatePopper():this.close()},this.open=async()=>{if(this.popper){if("open"===this.status)return Promise.resolve(null)}else this.initialize();this.popperContent?.removeAttribute("hidden"),this.updateOptions({});const t=this.showElement(this._options.popper,!0);return this.setStatus("open",t),t?.finished??Promise.resolve(null)},this.close=async t=>{if(t&&!this._options.allowCloseByEvent)return Promise.resolve(null);if(t&&(t.preventDefault(),t.stopPropagation()),"open"!==this.status)return Promise.resolve(null);const e=this.hideElement(this._options.popper,!0);return this.setStatus("closed",e),e?.finished??Promise.resolve(null)},this.toggle=async t=>"open"!==this.status?this.open():this.close(t),this.updatePopper=t=>{if(!this.popper)return null;const e=this.actualPosition;let i=null;try{i=this.popper.update(t)}catch(t){return null}const n=d(i);return n!==e&&(this.setActualPosition(n),this.host.requestUpdate()),i},this.setStatus=(t,e)=>{this.status=t,this.statusAnimation=e,this.statusAnimation?.finished.then((()=>{this.updateAriaStates()}))},this.setActualPosition=t=>{this.actualPosition=t},this.handleContainerResize=p((()=>{if("open"!==this.status)return;const t=(this._options.containerElement??document.documentElement).getBoundingClientRect();this.containerSizeChanged(t)&&(this._containerSize=t,this.updatePopper({...this._options,container:t}))}),80),this.getKeyframes=(t,e="show",i)=>{try{return new KeyframeEffect(t,[{visibility:"hidden",opacity:"0"},{visibility:"visible",opacity:"1"}],{fill:"both",direction:"show"===e?"normal":"reverse",duration:i,easing:"ease-in-out"})}catch(i){return()=>{"show"===e?(t.style.visibility="visible",t.style.opacity="1"):(t.style.visibility="hidden",t.style.opacity="0")}}},(this.host=t).addController(this),this._options={...s,containerElement:i,scrollContainerElement:n,allowCloseByEvent:o},this.actualPosition=this._options.position||null}async hostConnected(){await this.host.updateComplete,this.updateAriaStates(!0)}initialize(){this._containerSize=(this._options.containerElement??document.documentElement).getBoundingClientRect(),this.popper=((t,e,i)=>{const n="object"!=typeof t||t instanceof HTMLElement?{reference:t,popper:e,...i}:t;return{update(t=n){const{reference:e,popper:i}=Object.assign(n,t);if(!i||!e)throw new Error("Popper- or reference-element missing.");return l(e,i,n)}}})({...this._options,container:this._containerSize}),this.resizeObserver=new ResizeObserver(this.handleContainerResize),this._options.containerElement&&this.resizeObserver.observe(this._options.containerElement);(this._options.scrollContainerElement??window).addEventListener("scroll",this.reposition),this.replaceElement(void 0,this._options.popper)}hostDisconnected(){this._options.containerElement&&this.resizeObserver?.unobserve(this._options.containerElement);(this._options.scrollContainerElement??window).removeEventListener("scroll",this.reposition)}getOptions(){return this._options}updateOptions({...t}){const e={...this._options,...t},i={...e};this.popper&&(this._containerSize=(e.containerElement??document.documentElement).getBoundingClientRect(),i.container=this._containerSize);const n=i.popperElementKey||"popperElement";!i.popper&&n in this.host&&(i.popper=this.host[n]);const o=i.referenceElementKey||"popperReferenceElement";!i.reference&&o in this.host&&(i.reference=this.host[o]),i.popper!==this._options.popper&&this.replaceElement(this._options.popper,i.popper),i.containerElement!==this._options.containerElement&&(this._options.containerElement&&(this.resizeObserver?.unobserve(this._options.containerElement),this._options.containerElement.removeEventListener("faceplate-close",this.close)),i.containerElement&&(this.resizeObserver?.observe(i.containerElement),i.containerElement.addEventListener("faceplate-close",this.close))),this._options=i,this.updatePopper({...this._options,position:this.getPosition(i)})}get currentState(){return{state:this.status,animationFinished:this.statusAnimation?.finished.then((()=>{}))??Promise.resolve()}}showElement(t,e=!0){if(t)return t.style.display="",this.updatePopper(),u(this.getKeyframes(t,"show",e?150:0))}hideElement(t,e="open"===this.status){if(!t)return;if("closed"===this.status)return void(t.style.display="none");const i=u(this.getKeyframes(t,"hide",e?150:0));return i?.finished.catch((()=>{})).then((()=>{"closed"===this.status&&(t.style.display="none"),i?.cancel()})),i}replaceElement(t,e){t&&(this.hideElement(t,!1),t.removeEventListener("faceplate-close",this.close)),e&&("open"===this.status?this.showElement(e,!1):this.hideElement(e,!1),e.addEventListener("faceplate-close",this.close))}}h.defaultPopperContentStyles=t`[faceplate-popper-content]{position:fixed;visibility:hidden;opacity:0}`;const u=t=>{if("function"==typeof t)return t();if(!t.target)return;t.target.getAnimations().forEach((t=>t.cancel()));const e=new Animation(t);return e.play(),e},d=t=>{if(!t)return null;const[e,i]=t,n=e?{t:"top",b:"bottom",l:"left",r:"right"}[e]:null,o=i?{s:"start",m:"middle",e:"end"}[i]:null;return n&&o?`${n}-${o}`:null};let m=n;async function f(t){const e={input:t},{data:n,errors:o}=await m({operation:i.RemoveHighlightedPost,variables:e});if(o?.length)throw new Error(r());const{removeHighlightedPost:s}=n;if(!s?.ok)throw new Error(r())}const g="moderator",_=()=>o({source:g,action:"click",noun:"assign_flair_dialog"}),b=()=>o({source:g,action:"click",noun:"assign_flair_confirm"}),E=()=>o({source:g,action:"click",noun:"assigned_flair_edit_dialog"}),y=()=>o({source:g,action:"click",noun:"assigned_flair_edit_save"}),v=t=>o({source:g,action:"click",noun:"username_input"},{action_info:t}),w=()=>o({source:g,action:"click",noun:"user_search"}),S=()=>o({source:g,action:"click",noun:"remove_assigned_userflair_dialog"}),C=()=>o({source:g,action:"click",noun:"remove_assigned_userflair_confirm"}),P=()=>o({source:g,action:"click",noun:"table_pagination"}),z=({isEnabled:t,subredditId:e,subredditName:i})=>o({source:"userflairmanagement",action:"click",noun:"enable_user_flair_prompt"},{action_info:{page_type:s.UserFlairSettingsPrompt},setting:{value:t?"1":"0"},subreddit:{id:e,name:i}}),A=({isEnabled:t,type:e,subredditId:i,subredditName:n})=>o({source:"flair_prompt",action:"submit",noun:"enable_user_flair_prompt"},{action_info:{page_type:s.UserFlairSettingsPrompt,reason:t?"1":"0",type:e},subreddit:{id:i,name:n}}),O="user-flair-assign-modal",R="pageNumber",k="pageSize",B="before",T="after",F="query",H="user-flair__user-delete",L="user-flair__user-edit",j="user-flair__user-delete-modal";export{h as P,R as Q,O as U,_ as a,S as b,C as c,w as d,E as e,P as f,H as g,L as h,j as i,k as j,B as k,T as l,F as m,v as n,y as o,b as p,A as q,f as r,z as s};
