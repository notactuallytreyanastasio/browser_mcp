import{I as t,g as s}from"./icon-82dd10b4.js";import{c as o,M as e,O as i,T as a}from"./shell-2264602c.js";import{P as n,g as d}from"./utils-19e4b642.js";var r,h;!function(t){t.Regular="regular",t.Semibold="semibold"}(r||(r={})),function(t){t.Small="sm",t.Medium="md",t.Large="lg"}(h||(h={})),h.Small,t.ExtraSmall,h.Medium,t.Small,h.Large,t.Medium;const c={sm:"text-12",md:"text-14",lg:"text-16"},l={always:"underline",hover:"hover:underline",none:"no-underline hover:no-underline"},m={primary:"",secondary:"text-secondary-plain hover:text-secondary-plain-hover no-visited visited:text-secondary-plain","plain-weak":"text-secondary-plain-weak hover:text-secondary-plain-hover no-visited visited:text-secondary-plain-weak",media:"text-media-onbackground no-visited visited:text-media-onbackground",inverted:"text-inverted-secondary-plain hover:text-inverted-secondary-plain-hover no-visited visited:text-neutral-background-weak"},u=({attributes:t,children:o,fontWeight:e="regular",size:i,suppressVisitedStyle:a=!1,underline:n="hover",visited:d,appearance:r="primary",trailingIcon:h})=>{const{html:u,createElement:p}=s(),y=u`${o}${h?u`<span class="ml-2xs align-middle">${h}</span>`:""}`,P=`${t?.className||""} a cursor-pointer\n  ${r?m[r]:""}\n  ${i?c[i]:""}\n  ${"semibold"===e?"font-semibold":""}\n  ${a?"no-visited":""}\n  ${n?l[n]:""}\n  ${d?"visited":""}`;return p("a",{...t,rpl:!0,className:P},y)};class p{constructor(t){this.handlePromotePostSuccess=({adAccount:t,postId:s})=>{if(s===this.host.postId){this.host.hasPromotedPostAnalytics||(this.host.hasPromotedPostAnalytics=!0);this.host.promotedAdAccounts.find((s=>s.id===t.id))||this.host.promotedAdAccounts.push(t)}},this.handleClick=()=>{this.host.hasPromotedPostAnalytics?this.host.dispatchEvent(o("toggle-promote-post-insights",{promotedAdAccounts:this.host.promotedAdAccounts})):this.host.promotePostIdentity&&n.activateAndOpenPromotePostModal({postId:this.host.postId,postType:this.host.postType,subredditName:this.host.subredditPrefixedName??"",identity:this.host.promotePostIdentity})},this.load=async()=>{try{const t=e({operation:i.BoostedPostAdInsights,variables:{profileId:this.host.authorId,postId:this.host.postId,includeIdentity:!p.queryWithIdentityPromise,includeAdAccounts:!p.queryWithIdentityPromise}});p.queryWithIdentityPromise||(p.queryWithIdentityPromise=t);const s=await p.queryWithIdentityPromise,{adAccounts:o,email:a,isOnboarded:n}=d(s);this.host.promotePostIdentity={adAccounts:o,email:a,isOnboarded:n};const r=await t;if(r.data.adInsights){this.host.hasPromotedPostAnalytics=!!r.data.adInsights.edges.length;const t=new Set(r.data.adInsights.edges.map((t=>t?.node?.adAccountId)));this.host.promotedAdAccounts=Array.from(t).map((t=>o.find((s=>s.id===t))))}}catch(t){this.host.promotePostIdentity={adAccounts:[],email:"",isOnboarded:!1},this.host.hasPromotedPostAnalytics=!1,this.host.promotedAdAccounts=[]}this.host.hasLoadedPromotedPostAnalytics=!0},this.host=t,this.host.addController(this)}async hostConnected(){this.host.isPromoteablePost&&(this.host.pubsub.subscribe(a.PromotePostSuccess,this.handlePromotePostSuccess,!1),await this.load())}hostDisconnected(){this.host.isPromoteablePost&&this.host.pubsub.unsubscribe(a.PromotePostSuccess,this.handlePromotePostSuccess)}}export{r as A,p as P,u as a,h as b};
