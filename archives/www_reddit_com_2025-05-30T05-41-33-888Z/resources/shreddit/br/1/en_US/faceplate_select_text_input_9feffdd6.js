import{_ as e,n as t,m as i,J as a,e as s,a_ as l,aV as r}from"./shell-2264602c.js";import{c as o}from"./filterNullish-60f7e90f.js";import{x as n,l as p,U as h,a as d}from"./icon-82dd10b4.js";import"./community-picker-9f84d972.js";import{S as c}from"./select-controller-e11d5e4c.js";import{F as u}from"./constants-d65b7b38.js";import{T as v}from"./validate-image-b0892d29.js";let m=class extends u{constructor(){super(...arguments),this.appearance=v.SECONDARY,this.label="",this.clearable=!1,this.multiple=!1,this.required=!1,this.helperTextLevel=null,this.helperTextPlaceholder="",this.helperTextAriaLive="polite",this.helperTextMessage="",this.readonly=!1,this.inputRef=l(),this._selectController=new c(this),this.focus=()=>{this.inputRef.value?.focus()},this.syncInputValidation=(e=!1)=>{const t=this.options.map((e=>e.value)),i=this.inputRef?.value?.value,a=this.value||this.arbitrary&&i||!this.arbitrary&&t.includes(i);if(this.required&&!a){const t=this.inputRef?.value?._internals.validationMessage;this.dropdownMenu?.hidden&&t&&(e?this.form?.invalidateFieldWithMessage(this.name,t):this.setCustomValidity(t))}else this.form?.invalidateFieldWithMessage(this.name,"")},this.resetFaceplateDirty=()=>{this.removeAttribute("faceplate-dirty")},this.matchOptionsToInput=e=>{if(this.autocomplete&&!this.multiple){const t=e.currentTarget?.value;this.options.forEach((e=>{const i=e.displayText?.toLowerCase().trim();if(this.onFilterOption?this.onFilterOption?.(t,e):i?.startsWith(t.toLowerCase())){if(!t)return e.removeAttribute("hidden"),void(e.matchedText="");e.hasAttribute("hidden")&&e.removeAttribute("hidden"),e.matchedText=e.displayText?.slice(0,t.length)}else e.setAttribute("hidden","")})),this._selectController.focusedIndex=0}},this.clear=e=>{e.preventDefault(),e.stopPropagation(),this._selectController.selectedOptions.forEach((e=>{e.resetSelection()})),this.inputRef.value&&(this.inputRef.value.value="")},this.handleKeyBindings=e=>{this.readonly||this.multiple?e.preventDefault():"Backspace"!==e.key||this.multiple||(this._selectController.value="")},this.getTextField=()=>n`<faceplate-text-input ?disabled="${this.disabled}" novalidate ${r(this.inputRef)} appearance="${this.appearance}" role="combobox" aria-controls="menu" aria-expanded="${!this.hidden}" id="trigger" faceplate-popper-trigger aria-label="${this.label}" value="${this._selectController.getSelectedOptionsAsStr()}" ?required="${this.required}" @input="${this.matchOptionsToInput}" suppress-internal-clicks persistent-trailing-icon with-select helper-text-aria-live="${p(this.helperTextAriaLive??void 0)}" helper-text-message="${p(this.helperTextMessage)}" helper-text-level="${p(this.helperTextLevel??void 0)}" helper-text-placeholder="${p(this.helperTextPlaceholder)}" helper-text-screen-reader-msg="${p(this.helperTextScreenReaderMsg)}" aria-autocomplete="list" name="${this.name}"> <span slot="label">${this.label}</span> <slot name="clearButton" slot="clearButton" @click="${this.clear}"></slot> <span slot="trailingIconButton">${h({attributes:{"aria-hidden":"true"}})}</span> </faceplate-text-input>`}get referenceElement(){return this.inputRef.value}get selectedOptions(){return this._selectController.selectedOptions}get selectedIndex(){return this._selectController.selectedIndex}get value(){return this._selectController.value}set value(e){e!==this.value&&(this._selectController.value=e)}connectedCallback(){super.connectedCallback(),this.addEventListener("focus",this.resetFaceplateDirty),this.addEventListener("keydown",this.handleKeyBindings)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("focus",this.resetFaceplateDirty),this.removeEventListener("keydown",this.handleKeyBindings)}async firstUpdated(){super.firstUpdated(),this.setupValidationSync()}async setupValidationSync(){const e=await o(this);e&&this.isConnected&&(this.inputRef.value?.hasValidationHelpers||this.inputRef.value?.setFormValidationHelpers(e),this.syncInputValidation(),this.addEventListener(e.validationTrigger,(()=>this.syncInputValidation(!0))),e.addEventListener("faceplate-submit",(()=>this.syncInputValidation(!0))))}static get styles(){return d`:host{display:inline-block}:host([disabled]){cursor:not-allowed}faceplate-text-input{flex:1}:host([readonly]){caret-color:transparent}faceplate-menu{height:var(--faceplate-select-menu-height,auto);width:var(--faceplate-select-menu-width,auto);max-height:var(--faceplate-select-menu-max-height,auto);max-width:var(--faceplate-select-menu-max-width,auto);overflow:auto}`}render(){return n` <faceplate-dropdown-menu ?disabled="${this.disabled}" position="bottom-start" manual-trigger-focus> ${this.getTextField()} <faceplate-menu part="menu" slot="menu" id="menu" ariarole="listbox" faceplate-popper-content disable-auto-focus> <slot></slot> </faceplate-menu> </faceplate-dropdown-menu> `}};e([t({type:String})],m.prototype,"appearance",void 0),e([t({type:String})],m.prototype,"label",void 0),e([t({type:Boolean})],m.prototype,"clearable",void 0),e([t({type:Boolean})],m.prototype,"multiple",void 0),e([t({type:Boolean})],m.prototype,"required",void 0),e([t({type:String})],m.prototype,"autocomplete",void 0),e([t({type:Boolean})],m.prototype,"arbitrary",void 0),e([t({type:String,reflect:!0,attribute:"helper-text-level"})],m.prototype,"helperTextLevel",void 0),e([t({type:String,attribute:"helper-text-placeholder"})],m.prototype,"helperTextPlaceholder",void 0),e([t({type:String,reflect:!0,attribute:"helper-text-aria-live"})],m.prototype,"helperTextAriaLive",void 0),e([t({type:String,attribute:"helper-text-message"})],m.prototype,"helperTextMessage",void 0),e([t({type:String,attribute:"helper-text-screen-reader-msg"})],m.prototype,"helperTextScreenReaderMsg",void 0),e([t()],m.prototype,"onFilterOption",void 0),e([t({type:Boolean})],m.prototype,"readonly",void 0),e([i()],m.prototype,"options",void 0),e([i({selector:"faceplate-option:not([hidden])"})],m.prototype,"visibleOptions",void 0),e([i()],m.prototype,"triggerSlot",void 0),e([a("faceplate-dropdown-menu")],m.prototype,"dropdownMenu",void 0),m=e([s("faceplate-select-text-input")],m);
