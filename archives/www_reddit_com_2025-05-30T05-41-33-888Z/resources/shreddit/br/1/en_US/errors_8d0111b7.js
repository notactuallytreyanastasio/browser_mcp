var t,e;!function(t){t.Standard="hidden",t.Webkit="webkitHidden"}(t||(t={})),function(t){t.hidden="visibilitychange",t.webkitHidden="webkitvisibilitychange",t.mozHidden="mozvisibilitychange",t.msHidden="msvisibilitychange"}(e||(e={}));const i=Object.keys(e),s={initialized:!1,visibilityCallbacks:new Array},n=()=>{},r=i.find((t=>void 0!==document[t]));var a=(t=n,i={immediate:!1})=>{const a=s.visibilityCallbacks.length;return s.visibilityCallbacks.includes(t)||(i.shouldBeCalledFirst?s.visibilityCallbacks.unshift(t):s.visibilityCallbacks.push(t)),!s.initialized&&r&&(s.initialized=!0,document.addEventListener(e[r],(()=>{const t=!document[r];s.visibilityCallbacks.forEach((e=>e(t)))})),i.immediate&&t(!document[r])),i.resetInit&&(s.initialized=!1),a<s.visibilityCallbacks.length};const o=t=>{const e=s.visibilityCallbacks.length,i=s.visibilityCallbacks.indexOf(t);return-1!==i&&s.visibilityCallbacks.splice(i,1),e>s.visibilityCallbacks.length},l={LoadFail:0,BadSignature:1,BadTimestamp:2,BadSettingValue:3,BadFormat:4,UnknownSetting:5};class c extends Error{code;line;constructor(t){super(t.reason),this.code=t.code,this.line=t.line}}const h=/\r?\n|\r/gm;class u{writable;readable;constructor(t){const e=new d(t);this.writable=new WritableStream({write(t){e.transform(t)},close(){e.close()}}),this.readable=new ReadableStream({start(t){e.onLine=e=>t.enqueue(e),e.onClose=()=>t.close()}})}}class d{x="";y;onLine;onClose;constructor(t){this.y=new TextDecoder(t)}transform(t){this.x+=this.y.decode(t,{stream:!0});const e=this.x.split(h);this.x=e.pop()||"";for(let t=0;t<e.length;t++)this.onLine(e[t].trim())}close(){this.x&&this.onLine(this.x.trim()),this.x="",this.onClose()}}async function f(t,e){const i=e?.type??"vtt";let s,n;if("string"==typeof i)switch(i){case"srt":s=(await Promise.resolve().then((function(){return mt}))).default;break;case"ssa":case"ass":s=(await Promise.resolve().then((function(){return Ot}))).default;break;default:s=(await Promise.resolve().then((function(){return F}))).default}else s=i;const r=t.getReader(),a=s(),o=!!e?.strict||!!e?.errors;await a.init({strict:!1,...e,errors:o,type:i,cancel(){r.cancel(),n=a.done(!0)}});let l=1;for(;;){const{value:t,done:e}=await r.read();if(e){a.parse("",l),n=a.done(!1);break}a.parse(t,l),l++}return n}async function p(t,{encoding:e="utf-8",...i}={}){return f(t.pipeThrough(new u(e)),i)}class g extends EventTarget{id="";startTime;endTime;text;pauseOnExit=!1;constructor(t,e,i){super(),this.startTime=t,this.endTime=e,this.text=i}addEventListener(t,e,i){super.addEventListener(t,e,i)}removeEventListener(t,e,i){super.removeEventListener(t,e,i)}}const b="undefined"==typeof document,m=b?g:window.VTTCue;class v extends m{region=null;vertical="";snapToLines=!0;line="auto";lineAlign="start";position="auto";positionAlign="auto";size=100;align="center";style}class w{id="";width=100;lines=3;regionAnchorX=0;regionAnchorY=100;viewportAnchorX=0;viewportAnchorY=100;scroll=""}function y(t){const e=parseInt(t,10);return Number.isNaN(e)?null:e}function k(t){const e=parseInt(t.replace("%",""),10);return!Number.isNaN(e)&&e>=0&&e<=100?e:null}function x(t){if(!t.includes(","))return null;const[e,i]=t.split(",").map(k);return null!==e&&null!==i?[e,i]:null}function T(t){const e=parseFloat(t);return Number.isNaN(e)?null:e}const $=/[:=]/,C=/^[\s\t]*(region|vertical|line|position|size|align)[:=]/,A=/^REGION:?[\s\t]+/,S=/[\s\t]+/,j=/[\s\t]*-->[\s\t]+/,O=/start|center|end|left|right/,E=/start|center|end/,N=/line-(?:left|right)|center|auto/,M=/^(?:(\d{1,2}):)?(\d{2}):(\d{2})(?:\.(\d{1,3}))?$/;var z=(t=>(t[t.None=0]="None",t[t.Header=1]="Header",t[t.Cue=2]="Cue",t[t.Region=3]="Region",t[t.Note=4]="Note",t))(z||{});class B{f;c=0;g={};h={};j=[];a=null;b=null;k=[];d;l="";async init(t){this.f=t,t.strict&&(this.c=1),t.errors&&(this.d=(await Promise.resolve().then((function(){return Nt}))).ParseErrorBuilder)}parse(t,e){if(""===t)this.a?(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null):this.b?(this.h[this.b.id]=this.b,this.f.onRegion?.(this.b),this.b=null):1===this.c&&(this.i(t,e),this.f.onHeaderMetadata?.(this.g)),this.c=0;else if(this.c)switch(this.c){case 1:this.i(t,e);break;case 2:if(this.a){const i=this.a.text.length>0;!i&&C.test(t)?this.m(t.split(S),e):this.a.text+=(i?"\n":"")+t}break;case 3:this.n(t.split(S),e)}else if(t.startsWith("NOTE"))this.c=4;else if(t.startsWith("REGION"))this.c=3,this.b=new w,this.n(t.replace(A,"").split(S),e);else if(t.includes("--\x3e")){const i=this.o(t,e);i&&(this.a=new v(i[0],i[1],""),this.a.id=this.l,this.m(i[2],e)),this.c=2}else 1===e&&this.i(t,e);this.l=t}done(){return{metadata:this.g,cues:this.j,regions:Object.values(this.h),errors:this.k}}i(t,e){if(e>1){if($.test(t)){const[e,i]=t.split($);e&&(this.g[e]=(i||"").replace(S,""))}}else t.startsWith("WEBVTT")?this.c=1:this.e(this.d?.p())}o(t,e){const[i,s=""]=t.split(j),[n,...r]=s.split(S),a=P(i),o=P(n);if(null!==a&&null!==o&&o>a)return[a,o,r];null===a&&this.e(this.d?.q(i,e)),null===o&&this.e(this.d?.r(n,e)),null!=a&&null!==o&&o>a&&this.e(this.d?.s(a,o,e))}n(t,e){let i;for(let s=0;s<t.length;s++)if($.test(t[s])){i=!1;const[n,r]=t[s].split($);switch(n){case"id":this.b.id=r;break;case"width":const t=k(r);null!==t?this.b.width=t:i=!0;break;case"lines":const s=y(r);null!==s?this.b.lines=s:i=!0;break;case"regionanchor":const a=x(r);null!==a?(this.b.regionAnchorX=a[0],this.b.regionAnchorY=a[1]):i=!0;break;case"viewportanchor":const o=x(r);null!==o?(this.b.viewportAnchorX=o[0],this.b.viewportAnchorY=o[1]):i=!0;break;case"scroll":"up"===r?this.b.scroll="up":i=!0;break;default:this.e(this.d?.t(n,r,e))}i&&this.e(this.d?.u(n,r,e))}}m(t,e){let i;for(let s=0;s<t.length;s++)if(i=!1,$.test(t[s])){const[n,r]=t[s].split($);switch(n){case"region":const t=this.h[r];t&&(this.a.region=t);break;case"vertical":"lr"===r||"rl"===r?(this.a.vertical=r,this.a.region=null):i=!0;break;case"line":const[s,a]=r.split(",");if(s.includes("%")){const t=k(s);null!==t?(this.a.line=t,this.a.snapToLines=!1):i=!0}else{const t=T(s);null!==t?this.a.line=t:i=!0}E.test(a)?this.a.lineAlign=a:a&&(i=!0),"auto"!==this.a.line&&(this.a.region=null);break;case"position":const[o,l]=r.split(","),c=k(o);null!==c?this.a.position=c:i=!0,l&&N.test(l)?this.a.positionAlign=l:l&&(i=!0);break;case"size":const h=k(r);null!==h?(this.a.size=h,h<100&&(this.a.region=null)):i=!0;break;case"align":O.test(r)?this.a.align=r:i=!0;break;default:this.e(this.d?.v(n,r,e))}i&&this.e(this.d?.w(n,r,e))}}e(t){if(t){if(this.k.push(t),this.f.strict)throw this.f.cancel(),t;this.f.onError?.(t)}}}function P(t){const e=t.match(M);if(!e)return null;const i=e[1]?parseInt(e[1],10):0,s=parseInt(e[2],10),n=parseInt(e[3],10),r=e[4]?parseInt(e[4].padEnd(3,"0"),10):0;return i<0||s<0||n<0||r<0||s>59||n>59?null:3600*i+60*s+n+r/1e3}var F=Object.freeze({__proto__:null,VTTBlock:z,VTTParser:B,default:function(){return new B},parseVTTTimestamp:P});const L=/[0-9]/,I=/[\s\t]+/,V={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span",timestamp:"span"},_={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},R=/&(?:amp|lt|gt|quot|#(0+)?39|nbsp|lrm|rlm);/g,H=new Set(["white","lime","cyan","red","yellow","magenta","blue","black"]),W=new Set(Object.keys(V));function q(t){let e,i="",s=1,n=[],r=[];for(let n=0;n<t.text.length;n++){const c=t.text[n];switch(s){case 1:"<"===c?(l(),s=2):i+=c;break;case 2:switch(c){case"\n":case"\t":case" ":a(),s=4;break;case".":a(),s=3;break;case"/":s=5;break;case">":a(),s=1;break;default:!i&&L.test(c)&&(s=6),i+=c}break;case 3:switch(c){case"\t":case" ":case"\n":o(),e&&e.class?.trim(),s=4;break;case".":o();break;case">":o(),e&&e.class?.trim(),s=1;break;default:i+=c}break;case 4:">"===c?(i=i.replace(I," "),"v"===e?.type?e.voice=Y(i):"lang"===e?.type&&(e.lang=Y(i)),i="",s=1):i+=c;break;case 5:">"===c&&(i="",e=r.pop(),s=1);break;case 6:if(">"===c){const n=P(i);null!==n&&n>=t.startTime&&n<=t.endTime&&(i="timestamp",a(),e.time=n),i="",s=1}else i+=c}}function a(){if(W.has(i)){const s=e;e={tagName:V[t=i],type:t,children:[]},s?(r[r.length-1]!==s&&r.push(s),s.children.push(e)):n.push(e)}var t;i="",s=1}function o(){if(e&&i){const t=i.replace("bg_","");H.has(t)?e[i.startsWith("bg_")?"bgColor":"color"]=t:e.class=e.class?e.class+" "+i:i}i=""}function l(){if(!i)return;const t={type:"text",data:Y(i)};e?e.children.push(t):n.push(t),i=""}return 1===s&&l(),n}function Y(t){return t.replace(R,(t=>_[t]||"'"))}function D(t,e,i){t.style.setProperty(`--${e}`,i+"")}function X(t,e,i=!0){t.setAttribute(`data-${e}`,!0===i?"":i+"")}function U(t,e){t.setAttribute("data-part",e)}function G(t,e=0){return Q(q(t),e)}function Q(t,e=0){let i,s="";for(const n of t)if("text"===n.type)s+=n.data;else{const t="timestamp"===n.type;i={},i.class=n.class,i.title="v"===n.type&&n.voice,i.lang="lang"===n.type&&n.lang,i["data-part"]="v"===n.type&&"voice",t&&(i["data-part"]="timed",i["data-time"]=n.time,i["data-future"]=n.time>e,i["data-past"]=n.time<e),i.style=`${n.color?`color: ${n.color};`:""}${n.bgColor?`background-color: ${n.bgColor};`:""}`;const r=Object.entries(i).filter((t=>t[1])).map((t=>`${t[0]}="${!0===t[1]?"":t[1]}"`)).join(" ");s+=`<${n.tagName}${r?" "+r:""}>${Q(n.children)}</${n.tagName}>`}return s}function J(t,e){if(!b)for(const i of t.querySelectorAll('[data-part="timed"]')){const t=Number(i.getAttribute("data-time"));Number.isNaN(t)||(t>e?X(i,"future"):i.removeAttribute("data-future"),t<e?X(i,"past"):i.removeAttribute("data-past"))}}const K=Symbol(0);function Z(t){return t instanceof HTMLElement?{top:t.offsetTop,width:t.clientWidth,height:t.clientHeight,left:t.offsetLeft,right:t.offsetLeft+t.clientWidth,bottom:t.offsetTop+t.clientHeight}:{...t}}function tt(t,e,i){switch(e){case"+x":t.left+=i,t.right+=i;break;case"-x":t.left-=i,t.right-=i;break;case"+y":t.top+=i,t.bottom+=i;break;case"-y":t.top-=i,t.bottom-=i}}function et(t,e){for(let n=0;n<e.length;n++)if(i=t,s=e[n],i.left<=s.right&&i.right>=s.left&&i.top<=s.bottom&&i.bottom>=s.top)return e[n];var i,s;return null}function it(t,e){return e.top>=0&&e.bottom<=t.height&&e.left>=0&&e.right<=t.width}function st(t,e,i){switch(i){case"+x":return e.left<0;case"-x":return e.right>t.width;case"+y":return e.top<0;case"-y":return e.bottom>t.height}}function nt(t,e){return Math.max(0,Math.min(t.width,e.right)-Math.max(0,e.left))*Math.max(0,Math.min(t.height,e.bottom)-Math.max(0,e.top))/(t.height*t.width)}function rt(t,e){return{top:e.top/t.height,left:e.left/t.width,right:(t.width-e.right)/t.width,bottom:(t.height-e.bottom)/t.height}}function at(t,e){return e.top=e.top*t.height,e.left=e.left*t.width,e.right=t.width-e.right*t.width,e.bottom=t.height-e.bottom*t.height,e}const ot=["top","left","right","bottom"];function lt(t,e,i,s){const n=rt(e,i);for(const e of ot)D(t,`${s}-${e}`,100*n[e]+"%")}function ct(t,e,i,s){let n,r=1,a={...e};for(let o=0;o<s.length;o++){for(;st(t,e,s[o])||it(t,e)&&et(e,i);)tt(e,s[o],1);if(it(t,e))return e;const l=nt(t,e);r>l&&(n={...e},r=l),e={...a}}return n||a}const ht=Symbol(0);function ut(t,e,i,s){let n,r=i.firstElementChild,a=function(t){if("auto"===t.line)return t.snapToLines?-1:100;return t.line}(e),o=[];if(i[K]||(i[K]=function(t,e){const i=Z(e),s=function(t){const e={};for(const i of ot)e[i]=parseFloat(t.style.getPropertyValue(`--cue-${i}`));return e}(e);e[ht]=!1,s.top&&(i.top=s.top,i.bottom=s.top+i.height,e[ht]="top");if(s.bottom){const n=t.height-s.bottom;i.top=n-i.height,i.bottom=n,e[ht]="bottom"}s.left&&(i.left=s.left);s.right&&(i.right=t.width-s.right);return rt(t,i)}(t,i)),n=at(t,{...i[K]}),i[ht])o=["top"===i[ht]?"+y":"-y","+x","-x"];else if(e.snapToLines){let i;switch(e.vertical){case"":o=["+y","-y"],i="height";break;case"rl":o=["+x","-x"],i="width";break;case"lr":o=["-x","+x"],i="width"}let s=parseFloat(getComputedStyle(r).lineHeight)||0,l=s*Math.round(a),c=t[i]+s,h=o[0];Math.abs(l)>c&&(l=l<0?-1:1,l*=Math.ceil(c/s)*s),a<0&&(l+=""===e.vertical?t.height:t.width,o=o.reverse()),tt(n,h,l)}else{const i=""===e.vertical,s=i?"+y":"+x",r=i?n.height:n.width;tt(n,s,(i?t.height:t.width)*a/100),tt(n,s,"center"===e.lineAlign?r/2:"end"===e.lineAlign?r:0),o=i?["-y","+y","-x","+x"]:["-x","+x","-y","+y"]}return n=ct(t,n,s,o),lt(i,t,n,"cue"),n}const dt=["-y","+y","-x","+x"];function ft(t,e,i,s){let n=Array.from(i.querySelectorAll('[data-part="cue-display"]')),r=0,a=Math.max(0,n.length-e.lines);for(let t=n.length-1;t>=a;t--)r+=n[t].offsetHeight;D(i,"region-height",r+"px"),i[K]||(i[K]=rt(t,Z(i)));let o={...i[K]};return o=at(t,o),o.width=i.clientWidth,o.height=r,o.right=o.left+o.width,o.bottom=o.top+r,o=ct(t,o,s,dt),lt(i,t,o,"region"),o}var pt=Object.freeze({__proto__:null,CaptionsRenderer:class{overlay;z;A=0;C="ltr";B=[];D=!1;E;h=new Map;j=new Map;get dir(){return this.C}set dir(t){this.C=t,X(this.overlay,"dir",t)}get currentTime(){return this.A}set currentTime(t){this.A=t,this.update()}constructor(t,e){this.overlay=t,this.dir=e?.dir??"ltr",t.setAttribute("translate","yes"),t.setAttribute("aria-live","off"),t.setAttribute("aria-atomic","true"),U(t,"captions"),this.G(),this.E=new ResizeObserver(this.I.bind(this)),this.E.observe(t)}changeTrack({regions:t,cues:e}){this.reset(),this.J(t);for(const t of e)this.j.set(t,null);this.update()}addCue(t){this.j.set(t,null),this.update()}removeCue(t){this.j.delete(t),this.update()}update(t=!1){this.H(t)}reset(){this.j.clear(),this.h.clear(),this.B=[],this.overlay.textContent=""}destroy(){this.reset(),this.E.disconnect()}I(){this.D=!0,this.K()}K=function(t,e){let i,s=null;function n(){r(),t(...i),i=void 0}function r(){clearTimeout(s),s=null}return function(){i=[].slice.call(arguments),r(),s=setTimeout(n,e)}}((()=>{this.D=!1,this.G();for(const t of this.h.values())t[K]=null;for(const t of this.j.values())t&&(t[K]=null);this.H(!0)}),50);G(){this.z=Z(this.overlay),D(this.overlay,"overlay-width",this.z.width+"px"),D(this.overlay,"overlay-height",this.z.height+"px")}H(t=!1){if(!this.j.size||this.D)return;let e,i=[...this.j.keys()].filter((t=>this.A>=t.startTime&&this.A<=t.endTime)).sort(((t,e)=>t.startTime!==e.startTime?t.startTime-e.startTime:t.endTime-e.endTime)),s=i.map((t=>t.region));for(let n=0;n<this.B.length;n++){if(e=this.B[n],i[n]===e)continue;if(e.region&&!s.includes(e.region)){const i=this.h.get(e.region.id);i&&(i.removeAttribute("data-active"),t=!0)}const r=this.j.get(e);r&&(r.remove(),t=!0)}for(let s=0;s<i.length;s++){e=i[s];let n=this.j.get(e);n||this.j.set(e,n=this.L(e));const r=this.F(e)&&this.h.get(e.region.id);r&&!r.hasAttribute("data-active")&&(requestAnimationFrame((()=>X(r,"active"))),t=!0),n.isConnected||((r||this.overlay).append(n),t=!0)}if(t){const t=[],s=new Set;for(let n=i.length-1;n>=0;n--){if(e=i[n],s.has(e.region||e))continue;const r=this.F(e),a=r?this.h.get(e.region.id):this.j.get(e);r?t.push(ft(this.z,e.region,a,t)):t.push(ut(this.z,e,a,t)),s.add(r?e.region:e)}}J(this.overlay,this.A),this.B=i}J(t){if(t)for(const e of t){const t=this.M(e);this.h.set(e.id,t),this.overlay.append(t)}}M(t){const e=document.createElement("div");return U(e,"region"),X(e,"id",t.id),X(e,"scroll",t.scroll),D(e,"region-width",t.width+"%"),D(e,"region-anchor-x",t.regionAnchorX),D(e,"region-anchor-y",t.regionAnchorY),D(e,"region-viewport-anchor-x",t.viewportAnchorX),D(e,"region-viewport-anchor-y",t.viewportAnchorY),D(e,"region-lines",t.lines),e}L(t){const e=document.createElement("div"),i=function(t){if("auto"===t.position)switch(t.align){case"start":case"left":return 0;case"right":case"end":return 100;default:return 50}return t.position}(t),s=function(t,e){if("auto"===t.positionAlign)switch(t.align){case"start":return"ltr"===e?"line-left":"line-right";case"end":return"ltr"===e?"line-right":"line-left";case"center":return"center";default:return`line-${t.align}`}return t.positionAlign}(t,this.C);if(U(e,"cue-display"),""!==t.vertical&&X(e,"vertical"),D(e,"cue-text-align",t.align),t.style)for(const i of Object.keys(t.style))e.style.setProperty(i,t.style[i]);if(this.F(t))D(e,"cue-offset",i-("line-right"===s?100:"center"===s?50:0)+"%");else if(D(e,"cue-writing-mode",""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl"),!t.style?.["--cue-width"]){let n=i;"line-left"===s?n=100-i:"center"===s&&i<=50?n=2*i:"center"===s&&i>50&&(n=2*(100-i));const r=t.size<n?t.size:n;""===t.vertical?D(e,"cue-width",r+"%"):D(e,"cue-height",r+"%")}const n=document.createElement("div");return U(n,"cue"),t.id&&X(n,"id",t.id),n.innerHTML=G(t),e.append(n),e}F(t){return t.region&&100===t.size&&""===t.vertical&&"auto"===t.line}},ParseError:c,ParseErrorCode:l,TextCue:g,VTTCue:v,VTTRegion:w,parseByteStream:p,parseResponse:async function(t,e){const i=await t;if(!i.ok||!i.body){let t;return{metadata:{},cues:[],regions:[],errors:[t]}}const s=i.headers.get("content-type")||"",n=s.match(/text\/(.*?)(?:;|$)/)?.[1],r=s.match(/charset=(.*?)(?:;|$)/)?.[1];return p(i.body,{type:n,encoding:r,...e})},parseTextStream:f,parseVTTTimestamp:P,renderVTTCueString:G,renderVTTTokensString:Q,tokenizeVTTCue:q,updateTimedVTTCueNodes:J});const gt=/,/g;class bt extends B{parse(t,e){if(""===t)this.a&&(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null),this.c=z.None;else if(this.c===z.Cue)this.a.text+=(this.a.text?"\n":"")+t;else if(t.includes("--\x3e")){const i=this.o(t,e);i&&(this.a=new v(i[0],i[1],i[2].join(" ")),this.a.id=this.l,this.c=z.Cue)}this.l=t}o(t,e){return super.o(t.replace(gt,"."),e)}}var mt=Object.freeze({__proto__:null,SRTParser:bt,default:function(){return new bt}});const vt=/^Format:[\s\t]*/,wt=/^Style:[\s\t]*/,yt=/^Dialogue:[\s\t]*/,kt=/[\s\t]*,[\s\t]*/,xt=/\{[^}]+\}/g,Tt=/\\N/g,$t=/^\[(.*)[\s\t]?Styles\]$/,Ct=/^\[(.*)[\s\t]?Events\]$/;class At{f;P=0;a=null;j=[];k=[];O=null;d;Q={};async init(t){this.f=t,t.errors&&(this.d=(await Promise.resolve().then((function(){return Nt}))).ParseErrorBuilder)}parse(t,e){if(this.P)switch(this.P){case 1:if(""===t)this.P=0;else if(wt.test(t))if(this.O){const e=t.replace(wt,"").split(kt);this.T(e)}else this.e(this.d?.N("Style",e));else vt.test(t)?this.O=t.replace(vt,"").split(kt):Ct.test(t)&&(this.O=null,this.P=2);break;case 2:if(""===t)this.R();else if(yt.test(t))if(this.R(),this.O){const i=t.replace(yt,"").split(kt),s=this.U(i,e);s&&(this.a=s)}else this.e(this.d?.N("Dialogue",e));else this.a?this.a.text+="\n"+t.replace(xt,"").replace(Tt,"\n"):vt.test(t)?this.O=t.replace(vt,"").split(kt):$t.test(t)?(this.O=null,this.P=1):Ct.test(t)&&(this.O=null)}else""===t||($t.test(t)?(this.O=null,this.P=1):Ct.test(t)&&(this.O=null,this.P=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}R(){this.a&&(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null)}T(t){let e,i,s,n,r="Default",a={},o="center",l="bottom",c=1.2,h=3,u=[];for(let d=0;d<this.O.length;d++){const f=this.O[d],p=t[d];switch(f){case"Name":r=p;break;case"Fontname":a["font-family"]=p;break;case"Fontsize":a["font-size"]=`calc(${p} / var(--overlay-height))`;break;case"PrimaryColour":const t=St(p);t&&(a["--cue-color"]=t);break;case"BorderStyle":h=parseInt(p,10);break;case"BackColour":n=St(p);break;case"OutlineColour":const d=St(p);d&&(s=d);break;case"Bold":parseInt(p)&&(a["font-weight"]="bold");break;case"Italic":parseInt(p)&&(a["font-style"]="italic");break;case"Underline":parseInt(p)&&(a["text-decoration"]="underline");break;case"StrikeOut":parseInt(p)&&(a["text-decoration"]="line-through");break;case"Spacing":a["letter-spacing"]=p+"px";break;case"AlphaLevel":a.opacity=parseFloat(p);break;case"ScaleX":u.push(`scaleX(${parseFloat(p)/100})`);break;case"ScaleY":u.push(`scaleY(${parseFloat(p)/100})`);break;case"Angle":u.push(`rotate(${p}deg)`);break;case"Shadow":c=1.2*parseInt(p,10);break;case"MarginL":a["--cue-width"]="auto",a["--cue-left"]=parseFloat(p)+"px";break;case"MarginR":a["--cue-width"]="auto",a["--cue-right"]=parseFloat(p)+"px";break;case"MarginV":i=parseFloat(p);break;case"Outline":e=parseInt(p,10);break;case"Alignment":const f=parseInt(p,10);switch(f>=4&&(l=f>=7?"top":"center"),f%3){case 1:o="start";break;case 2:o="center";break;case 3:o="end"}}}if(a.S=l,a["--cue-white-space"]="normal",a["--cue-line-height"]="normal",a["--cue-text-align"]=o,"center"===l?(a["--cue-top"]="50%",u.push("translateY(-50%)")):a[`--cue-${l}`]=(i||0)+"px",1===h&&(a["--cue-padding-y"]="0"),(1===h||n)&&(a["--cue-bg-color"]=1===h?"none":n),3===h&&s&&(a["--cue-outline"]=`${e}px solid ${s}`),1===h&&"number"==typeof e){const t=n??"#000";a["--cue-text-shadow"]=[s&&jt(1.2*e,1.2*c,s),s?jt(e*(e/2),c*(e/2),t):jt(e,c,t)].filter(Boolean).join(", ")}u.length&&(a["--cue-transform"]=u.join(" ")),this.Q[r]=a}U(t,e){const i=this.V(t),s=this.o(i.Start,i.End,e);if(!s)return;const n=new v(s[0],s[1],""),r={...this.Q[i.Style]||{}},a=i.Name?`<v ${i.Name}>`:"",o=r.S,l=i.MarginL&&parseFloat(i.MarginL),c=i.MarginR&&parseFloat(i.MarginR),h=i.MarginV&&parseFloat(i.MarginV);return l&&(r["--cue-width"]="auto",r["--cue-left"]=l+"px"),c&&(r["--cue-width"]="auto",r["--cue-right"]=c+"px"),h&&"center"!==o&&(r[`--cue-${o}`]=h+"px"),n.text=a+t.slice(this.O.length-1).join(", ").replace(xt,"").replace(Tt,"\n"),delete r.S,Object.keys(r).length&&(n.style=r),n}V(t){const e={};for(let i=0;i<this.O.length;i++)e[this.O[i]]=t[i];return e}o(t,e,i){const s=P(t),n=P(e);if(null!==s&&null!==n&&n>s)return[s,n];null===s&&this.e(this.d?.q(t,i)),null===n&&this.e(this.d?.r(e,i)),null!=s&&null!==n&&n>s&&this.e(this.d?.s(s,n,i))}e(t){if(t){if(this.k.push(t),this.f.strict)throw this.f.cancel(),t;this.f.onError?.(t)}}}function St(t){const e=parseInt(t.replace("&H",""),16);if(e>=0){return"rgba("+[255&e,e>>8&255,e>>16&255,(e>>24&255^255)/255].join(",")+")"}return null}function jt(t,e,i){const s=Math.ceil(2*Math.PI*t);let n="";for(let r=0;r<s;r++){const a=2*Math.PI*r/s;n+=t*Math.cos(a)+"px "+e*Math.sin(a)+"px 0 "+i+(r==s-1?"":",")}return n}var Ot=Object.freeze({__proto__:null,SSAParser:At,default:function(){return new At}});const Et={p:()=>new c({code:l.BadSignature,reason:"missing WEBVTT file header",line:1}),q:(t,e)=>new c({code:l.BadTimestamp,reason:`cue start timestamp \`${t}\` is invalid on line ${e}`,line:e}),r:(t,e)=>new c({code:l.BadTimestamp,reason:`cue end timestamp \`${t}\` is invalid on line ${e}`,line:e}),s:(t,e,i)=>new c({code:l.BadTimestamp,reason:`cue end timestamp \`${e}\` is greater than start \`${t}\` on line ${i}`,line:i}),w:(t,e,i)=>new c({code:l.BadSettingValue,reason:`invalid value for cue setting \`${t}\` on line ${i} (value: ${e})`,line:i}),v:(t,e,i)=>new c({code:l.UnknownSetting,reason:`unknown cue setting \`${t}\` on line ${i} (value: ${e})`,line:i}),u:(t,e,i)=>new c({code:l.BadSettingValue,reason:`invalid value for region setting \`${t}\` on line ${i} (value: ${e})`,line:i}),t:(t,e,i)=>new c({code:l.UnknownSetting,reason:`unknown region setting \`${t}\` on line ${i} (value: ${e})`,line:i}),N:(t,e)=>new c({code:l.BadFormat,reason:`format missing for \`${t}\` block on line ${e}`,line:e})};var Nt=Object.freeze({__proto__:null,ParseErrorBuilder:Et});export{t as V,e as a,a as o,pt as p,o as u};
