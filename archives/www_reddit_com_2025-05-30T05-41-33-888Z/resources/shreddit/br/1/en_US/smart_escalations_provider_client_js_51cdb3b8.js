import{_ as s,g as t,n as a,e as i,P as e,M as o,r,gY as u,u as n,T as l,O as c}from"./shell-2264602c.js";import{s as d,x as h}from"./icon-82dd10b4.js";import"./community-onboarding-completed-modal-client-js-933a29af.js";import"./age-gate-standalone-client-js-5357b0cf.js";import"./hui-user-drawer-client-js-c899bcbc.js";import"./TinyGesture-89d9957c.js";var m,b;!function(s){s.READY="ready",s.EMPTY="empty"}(m||(m={})),function(s){s.SUCCESS="success"}(b||(b={}));let S=class extends d{constructor(){super(...arguments),this.pubsub=new e(this),this.requestClientGQL=o,this.isDesktop=!0,this.isSubmit=!1,this.subredditId="",this.authorId="",this._activateFeature=async s=>r(s),this.initSmartEscalations=async({thingId:s,removalReasonId:t,authorId:a,subredditId:i,removalReasonDisplayText:e})=>{this.subredditId=i,this.authorId=a,await this._activateFeature({name:u,renderMode:n.Contents,queryParams:{thing_id:s,author_id:a,subreddit_id:i,is_moderator:!0,removal_reason_id:t,removal_reason_display_text:e,is_desktop:!!this.isDesktop}})},this.performAction=()=>{this.addRemovalReasonStatus===b.SUCCESS&&void 0!==this.smartEscalationsStatus&&(this.pubsub.publish(l.AddRemovalReasonClose),this.smartEscalationsStatus===m.READY&&this.openSmartEscalations(),this.addRemovalReasonStatus=void 0,this.smartEscalationsStatus=void 0)},this.updateRemovalReasonStatus=s=>{this.addRemovalReasonStatus=s},this.updateSmartEscalationStatus=s=>{this.smartEscalationsStatus=s},this.openSmartEscalations=async()=>{await(this.rplDialogSheet?.showModal())},this.closeSmartEscalations=async s=>{this.isSubmit=s?.isSubmit??!1,await(this.rplDialogSheet?.hide())},this.dismissSmartEscalations=async()=>{try{if(this.isSubmit)return;const s={input:{subredditID:this.subredditId,userID:this.authorId}};this.requestClientGQL({operation:c.DismissSmartEscalation,variables:s})}finally{this.isSubmit&&(this.isSubmit=!1),this.subredditId="",this.authorId=""}}}get rplDialogSheet(){return this.querySelector("rpl-dialog-sheet")}get featureRoot(){return document.querySelector("#smart-escalations-content-modal rpl-modal-card")}updated(s){(s.has("addRemovalReasonStatus")||s.has("smartEscalationsStatus"))&&this.performAction()}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(l.SmartEscalationsInit,this.initSmartEscalations,!1),this.pubsub.subscribe(l.SmartEscalationsDismiss,this.dismissSmartEscalations,!1),this.pubsub.subscribe(l.SmartEscalationsClose,this.closeSmartEscalations,!1),this.pubsub.subscribe(l.SmartEscalationsOpen,this.openSmartEscalations,!1),this.pubsub.subscribe(l.RemovalReasonStatus,this.updateRemovalReasonStatus,!1),this.pubsub.subscribe(l.SmartEscalationsStatus,this.updateSmartEscalationStatus,!1)}disconnectedCallback(){this.pubsub.unsubscribe(l.SmartEscalationsInit,this.initSmartEscalations),this.pubsub.unsubscribe(l.SmartEscalationsDismiss,this.dismissSmartEscalations),this.pubsub.unsubscribe(l.SmartEscalationsClose,this.closeSmartEscalations),this.pubsub.unsubscribe(l.SmartEscalationsOpen,this.openSmartEscalations),this.pubsub.unsubscribe(l.RemovalReasonStatus,this.updateRemovalReasonStatus),this.pubsub.unsubscribe(l.SmartEscalationsStatus,this.updateSmartEscalationStatus),super.disconnectedCallback()}render(){return h` <slot></slot>`}};s([a({type:Boolean,attribute:"is-desktop"})],S.prototype,"isDesktop",void 0),s([t()],S.prototype,"addRemovalReasonStatus",void 0),s([t()],S.prototype,"smartEscalationsStatus",void 0),S=s([i("smart-escalations-provider")],S);export{b as R,m as S};
