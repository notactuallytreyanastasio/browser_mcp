import{gO as e,gP as t,gQ as i,ao as o,_ as s,n as a,cP as n,gR as r,gS as h,a_ as l,gT as d,cS as c,cT as p,gU as g,a7 as u,aV as m,e as f}from"./shell-2264602c.js";import{a as b,x as v}from"./icon-82dd10b4.js";import{T as S}from"./TinyGesture-89d9957c.js";import{ay as y}from"./age-gate-standalone-client-js-5357b0cf.js";const k=(e,t,{parentBoundary:i=document.documentElement,root:o=document,cache:s=new Set})=>{const a=o.elementsFromPoint(e,t),n=[];for(const e of a)if(!s.has(e)){if(!y(i,e))break;n.push(e),s.add(e)}const r=[];for(const i of n)i.shadowRoot&&r.push(...k(e,t,{parentBoundary:i,root:i.shadowRoot,cache:s}));return[...n,...r]};class w{get inSwipe(){return this._inSwipe}set inSwipe(e){this._inSwipe!==e&&(this._inSwipe=e,this.host.requestUpdate("inSwipe",!this._inSwipe))}constructor(e,{recognitionThreshold:t=10,mouseSupport:i=!1}={recognitionThreshold:10,mouseSupport:!1}){this.host=e,this.mouseSupport=!1,this.rafId=null,this._inSwipe=!1,this.protectScrollInterference=!0,this.recognitionThreshold=t,this.mouseSupport=i}clearRaf(){this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null)}addListeners(e){this.gesture=new S(e,{mouseSupport:this.mouseSupport}),this.gesture.on("panstart",this.handleTouchStart.bind(this)),this.gesture.on("panmove",this.handleTouchMove.bind(this)),this.gesture.on("panend",this.handleTouchEnd.bind(this))}removeListeners(){this.gesture?.destroy()}reset(){const e=this.gesture?.element;e&&(this.removeListeners(),this.addListeners(e))}handleTouchStart(e){this.clearRaf(),this.gesture&&this.host.handleSwipeMayStart?.(this.gesture)}handleTouchMove(o){if(this.clearRaf(),!this.gesture)return;const s=(this.gesture.touchMoveY??0)<=0;if(!this.inSwipe&&Math.abs((this.gesture.touchStartY??0)-(this.gesture.touchEndY??0))>this.recognitionThreshold){if(this.protectScrollInterference){const[a,n]=x(o),r=k(a,n,{parentBoundary:this.gesture.element}).filter((t=>t instanceof HTMLElement&&e(t)));if(s&&r.some((e=>!t(e)))||!s&&r.some((e=>!i(e))))return this.reset()}!1!==this.host.handleSwipeWillStart?.({...this.gesture,swipeDirection:s?"up":"down"})?(this.inSwipe=!0,this.host.handleSwipeProgress?.({...this.gesture,swipeDirection:s?"up":"down"})):this.reset()}this.inSwipe&&this.gesture&&(this.rafId=requestAnimationFrame((()=>{this.host.handleSwipeProgress?.({...this.gesture,swipeDirection:s?"up":"down"})})))}handleTouchEnd(e){this.gesture&&(this.clearRaf(),this.inSwipe=!1,this.host.handleSwipeEnd?.(this.gesture))}disableScrollInterferenceProtection(){this.protectScrollInterference=!1}enableScrollInterferenceProtection(){this.protectScrollInterference=!0}}const x=e=>e instanceof MouseEvent?[e.clientX,e.clientY]:[e.touches[0].clientX,e.touches[0].clientY],C="expanded",D="normal",E="docked";var H=b`${o}:host{--transition-duration:250ms;display:contents}.dialog{--bottom-sheet-docked-height:'auto';--bottom-sheet-normal-height:'auto';--bottom-sheet-height:var(--bottom-sheet-normal-height)}.dialog{--bottom-sheet-expanded-height:85vh}@supports (height:95dvh){.dialog{--bottom-sheet-expanded-height:95dvh}}.dialog.state-normal{--bottom-sheet-height:1fr}.dialog.state-docked{--bottom-sheet-height:var(--bottom-sheet-docked-height)}.dialog.state-expanded{--bottom-sheet-height:var(--bottom-sheet-expanded-height)}.dialog{display:flex;align-items:center;justify-content:center;position:fixed;top:0;right:0;bottom:0;left:0;z-index:var(--z-index-dialog,1000);user-select:none;pointer-events:none;width:100vw}.dialog-panel{display:grid;grid-template-rows:auto var(--bottom-sheet-height);grid-auto-flow:column;position:fixed;z-index:2;bottom:0;touch-action:none;transform:translateY(100%);max-height:var(--bottom-sheet-expanded-height);width:100vw;background-color:var(--color-ui-modalbackground);border-top-left-radius:var(--radius-md);border-top-right-radius:var(--radius-md);box-shadow:var(--boxshadow-modal);transition:--bottom-sheet-height var(--transition-duration) ease,grid-template-rows var(--transition-duration) ease,transform var(--transition-duration) ease}.dialog.reflect-gesture .dialog-panel{grid-template-rows:auto var(--bottom-sheet-forced-height);transition:none}.dialog-variant-plain .dialog-panel{max-width:100%;max-height:100%;background-color:transparent;border-radius:initial;box-shadow:initial}.dialog-panel:focus{outline:0}.dialog-open{user-select:auto}.dialog-open .dialog-overlay,.dialog-open .dialog-panel{pointer-events:auto}.dialog-open .dialog-panel{opacity:1;transform:translateY(0)}.dialog-overlay{position:fixed;top:0;right:0;bottom:0;left:0;background-color:rgba(0,0,0,.5)}.dialog-overlay-blur{backdrop-filter:blur(var(--dialog-backdrop-blur, 4px))}.dialog-overlay-no-modal{display:none}.handle-container{display:flex;justify-content:center;align-items:flex-end;width:100%}.handle-container-inside{--handle-color:var(--color-neutral-border);padding-top:var(--rem8);padding-bottom:var(--rem4)}.handle-container-outside{--handle-color:var(--color-global-white);padding-bottom:var(--rem8);padding-top:var(--rem4);position:relative;top:-16px}.handle{display:block;background:var(--handle-color);width:var(--rem48);height:var(--rem4);border-radius:10000rem}`;let R=class extends r{constructor(){super(...arguments),this.resizeController=new h(this,{callback:()=>this.updateDimensions,elements:{slottedElement:()=>this.slottedElement,styledDialogChildWithHeader:()=>this.styledDialogChildWithHeader,panel:()=>this.panelRef.value}}),this.gestureController=new w(this,{recognitionThreshold:10}),this.slottedElement=null,this.styledDialogChildWithHeader=null,this.handleContainer=l(),this.animationNames={show:"bottomSheet.show",hide:"bottomSheet.hide",denyClose:"bottomSheet.denyClose",denyExpand:"bottomSheet.denyExpand",overlayShow:"bottomSheet.overlay.show",overlayHide:"bottomSheet.overlay.hide"},this.openState=D,this.dockable=!1,this.expandable=!1,this.handleDockButtonClicked=e=>{e.stopPropagation(),this.open&&(this.isDocked?this.undock():this.dock())},this.updateDimensions=async e=>{const t=this.slottedElement;t&&e.some((e=>e.target===t))&&this.slottedElement&&this.styledDialogChildWithHeader&&this.updateDockedHeight(),this.requestUpdate(),this.emitter.dispatch("resize")}}get isDocked(){return this.openState===E}get isExpanded(){return this.openState===C}get isNormal(){return this.openState===D}addOpenListeners(){super.addOpenListeners(),this.resizeController.observeAllElements(),this.portalContainer.addEventListener("rpl-modal-card:dock-button-clicked",this.handleDockButtonClicked),this.panelRef.value&&this.gestureController.addListeners(this.panelRef.value)}removeOpenListeners(){super.removeOpenListeners(),this.resizeController.unobserveAllElements(),this.gestureController.removeListeners(),this.portalContainer.removeEventListener("rpl-modal-card:dock-button-clicked",this.handleDockButtonClicked)}willUpdate(e){return e.has("dockable")&&!this.dockable&&this.isDocked&&(this.dockable=!0),e.has("expandable")&&!this.expandable&&this.isExpanded&&(this.expandable=!0),e.has("openState")&&this.isExpanded&&!this.expandable&&(this.openState=e.get("openState")??D),e.has("openState")&&this.isDocked&&!this.dockable&&(this.openState=e.get("openState")??D),(e.get("openState")||e.get("dockable"))&&this.styledDialogChildren.size>0&&this.styledDialogChildren.forEach((e=>{e.dockable=this.dockable,e.docked=this.isDocked})),e.has("openState")&&(this.isDocked?this.gestureController.disableScrollInterferenceProtection():this.gestureController.enableScrollInterferenceProtection()),super.willUpdate(e)}getCachedHeightContainer(e){return["forced","forcedInitial"].includes(e)?this.panelRef.value:this.dialogRef.value}setCachedHeight(e,t){this.getCachedHeightContainer(e)?.style.setProperty(Y[e],t)}getCachedHeight(e){const t=this.getCachedHeightContainer(e);return t?getComputedStyle(t).getPropertyValue(Y[e])??"auto":"auto"}async updateDockedHeight(){if(!this.styledDialogChildWithHeader)return;await d(this.styledDialogChildWithHeader);const e=this.styledDialogChildWithHeader.headerHeight,t=this.handleContainer.value?.clientHeight??16;e&&this.setCachedHeight("docked",`${e+t}px`)}async expand(){if(!this.open||!this.expandable||this.isExpanded||!this.panelRef.value)return;!this.emitter.dispatch("open-state-changed",{cancelable:!0,detail:{openState:C}})||(this.openState=C)}async collapse(){if(!this.open||!this.isExpanded||!this.panelRef.value)return;!this.emitter.dispatch("open-state-changed",{cancelable:!0,detail:{openState:D}})||(this.openState=D)}async dock(){if(!this.open||!this.dockable||this.isDocked||!this.panelRef.value)return;!this.emitter.dispatch("open-state-changed",{cancelable:!0,detail:{openState:E}})||(this.openState=E)}async undock(){if(!this.open||!this.isDocked||!this.panelRef.value)return;!this.emitter.dispatch("open-state-changed",{cancelable:!0,detail:{openState:D}})||(this.openState=D)}handleSwipeMayStart(){this.setCachedHeight("forcedInitial",`${this.panelRef?.value?.clientHeight}px`),this.setCachedHeight("forced",`var(${Y.forcedInitial})`)}handleSwipeWillStart({swipeDirection:e}){return!("down"===e&&this.blocking&&!this.isExpanded||"up"===e&&!this.expandable)}handleSwipeProgress({swipeDirection:e,touchMoveY:t}){null===t||this.isExpanded&&"up"===e||this.setCachedHeight("forced",`calc(var(${Y.forcedInitial}) - ${t??0}px)`)}handleSwipeEnd({touchMoveY:e,thresholdY:t}){if(!this.open||null==e)return;const i=e>=t,o=e<=-t;if(i&&this.isExpanded)this.collapse();else if(i&&this.isNormal)this.requestClose("gesture");else if(o&&this.isDocked)this.undock();else if(o&&this.isNormal&&this.expandable)this.expand();else if(o&&!this.isExpanded&&!this.expandable&&this.panelRef.value){const{keyframes:e,options:t}=c(this,this.animationNames.denyExpand);p(this.panelRef.value,e,t)}}handleSlotChange(e){this.styledDialogChildWithHeader=null,this.slottedElement=this.portalContainer.firstElementChild,this.slottedElement&&this.resizeController.replaceObservedElement("slottedElement")}handleDialogChildConnected(e){e.appearance="bottom-sheet",e.dockable=this.dockable,e.docked="docked"===this.openState,g(e)&&"headerHeight"in e&&(this.styledDialogChildWithHeader=e,this.resizeController.replaceObservedElement("styledDialogChildWithHeader"),this.updateDockedHeight())}handleDialogChildDisconnected(e){}renderDialogBaseClasses(){return{"reflect-gesture":this.gestureController.inSwipe,[`state-${this.openState}`]:!0}}renderTopOfDialog(){return v`<div class="${u({"handle-container":!0,["handle-container-"+(this.open&&this.modal.disableFocusTrap?"inside":"outside")]:!0})}" part="handle-container" ${m(this.handleContainer)}> <div class="handle"></div> </div>`}};R.styles=H,s([a({type:String,reflect:!0,attribute:"open-state"})],R.prototype,"openState",void 0),s([a({type:Boolean,reflect:!0})],R.prototype,"dockable",void 0),s([a({type:Boolean,reflect:!0})],R.prototype,"expandable",void 0),R=s([f("rpl-bottom-sheet")],R);const Y={forced:"--bottom-sheet-forced-height",forcedInitial:"--bottom-sheet-forced-initial-height",currentHeight:"--bottom-sheet-current-height",[E]:"--bottom-sheet-docked-height"},I=250;n("bottomSheet.show",{keyframes:[{opacity:0,transform:"translateY(100%)"},{opacity:1,transform:"translateY(0%)"}],options:{duration:I,easing:"ease"}}),n("bottomSheet.hide",{keyframes:[{opacity:1,transform:"translateY(0%)",maxHeight:"var(--bottom-sheet-forced-height)"},{opacity:0,transform:"translateY(100%)",maxHeight:"var(--bottom-sheet-forced-height)"}],options:{duration:I,easing:"ease"}}),n("bottomSheet.denyClose",{keyframes:[{transform:"translateY(0%)"},{transform:"translateY(4%)"},{transform:"translateY(0%)"}],options:{duration:I,easing:"ease-in"}}),n("bottomSheet.denyExpand",{keyframes:[{height:"var(--bottom-sheet-forced-height)"},{height:"var(--bottom-sheet-height)",transform:"translateY(0%)",offset:.2},{height:"var(--bottom-sheet-height)",transform:"translateY(4%)",offset:.5},{height:"var(--bottom-sheet-height)",transform:"translateY(0%)"}],options:{duration:375,easing:"ease-in"}}),n("bottomSheet.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:I}}),n("bottomSheet.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:I}});export{R};
